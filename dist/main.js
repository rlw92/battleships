(()=>{"use strict";var e={d:(t,o)=>{for(var r in o)e.o(o,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:o[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{jK:()=>c,o7:()=>y,P4:()=>f,VL:()=>i,hJ:()=>u,yR:()=>g,He:()=>m,w7:()=>h,sq:()=>s});const t={createGrids:(e,t,o)=>{let r=document.createElement("div");r.style.padding="10px",r.style.border=0===o||0===t?"none":"solid black 2px",r.textContent=o,r.style.textAlign="center",0===o&&"0"===e?r.textContent=t:0===t&&"0"!=e&&(r.textContent=e),r.dataset.hit="No",r.dataset.P1hit="N",r.dataset.P2hit="N",r.dataset.letter=e,r.dataset.number=t,r.classList.add("cell"),r.setAttribute("id",r.dataset.letter+r.dataset.number),document.getElementById("gameboard1").appendChild(r)},createGameboard:()=>{for(let e=0;e<11;e++)t.createGrids("0",0,e),t.createGrids("A",e),t.createGrids("B",e),t.createGrids("C",e),t.createGrids("D",e),t.createGrids("E",e),t.createGrids("F",e),t.createGrids("G",e),t.createGrids("H",e),t.createGrids("I",e),t.createGrids("J",e)}},o=function(e){let t=e.target.dataset.number,o=e.target.dataset.letter,r="blue";if("V"===y){let e=NaN;t>e&&(t=e),r="0"===t?"white":"grey";for(let e=0;e<s;e++)document.getElementById(o+(+t+e)).style.backgroundColor=r}else if("H"===y){let e=o.charCodeAt(0),r=NaN;e>r&&(e=r);for(let o=0;o<s;o++)document.getElementById(String.fromCharCode(e++)+t).style.backgroundColor="grey"}},r=function(e){e.target.backgroundColor="white";let t=e.target.dataset.number,o=e.target.dataset.letter,r=o+t;if(console.log(r),"V"===y){let e=NaN;t>e&&(t=e);for(let e=0;e<s;e++)document.getElementById(o+(+t+e)).style.backgroundColor="white"}else if("H"===y){let e=o.charCodeAt(0),r=NaN;e>r&&(e=r);for(let o=0;o<s;o++)document.getElementById(String.fromCharCode(e++)+t).style.backgroundColor="white"}},n=function(){let e=u;f===h[0]?e=u:f===h[1]&&(e=m);for(let t=0;t<e.length;t++)console.log(e[t]),document.getElementById(e[t]).style.backgroundColor="red"},l=function(){let e=document.querySelectorAll(".cell");for(let t=0;t<e.length;t++)e[t].style.backgroundColor="white"},a=function(e){"0"===e.target.dataset.number?e.target.style.backgroundColor="white":e.target.style.backgroundColor="red"},d=function(e){f===h[0]?c=e.target.dataset.P1hit:f===h[1]&&(c=e.target.dataset.P2hit),console.log(c),"Y"===c?e.target.style.backgroundColor="red":"N"===c&&(e.target.style.backgroundColor="white")};let s,c,i=[],g=[],u=[],m=[],y="V",h=["player1","player2"],f=h[0],C=i;f===h[0]?C=i:f===h[1]&&(C=g),document.getElementById("pip").textContent=f,document.getElementById("Chnge").addEventListener("click",(()=>{"V"===y?(y="H",document.getElementById("position").textContent="Horizontal"):"H"===y&&(y="V",document.getElementById("position").textContent="Vertical")})),document.getElementById("shwshipos").addEventListener("click",n);function b(e){console.log(e.target.dataset.letter);let t=i,o=u,r=e.target.dataset.letter,a=e.target.dataset.number,d=r+a;if(console.log(d),console.log(t.length),f===h[0]?(t=g,o=u,c=e.target.dataset.P1hit):f===h[1]&&(t=i,o=m,c=e.target.dataset.P2hit),"0"===a)console.log("Stay in the grid.");else if("Y"===c)console.log("Already been hit, try again.");else{f===h[0]?(t=g,o=u,c=e.target.dataset.P1hit="Y"):f===h[1]&&(t=i,o=m,c=e.target.dataset.P2hit="Y");for(let e=0;e<t.length;e++)for(let o=0;o<t[e].coordinates.length;o++)t[e].coordinates[o]===d&&(console.log(t[e].coordinates),t[e].coordinates.splice(o,1),t[e].hitShip(),t[e].isSunk(),p(),console.log(t[e].coordinates),console.log("Player one sunk ships: 0"),console.log("Player two sunk ships: 0"));o.push(d),console.log("P1 strikes: "+u),console.log("P2 strikes: "+m),f===h[0]?(f=h[1],C=g,document.getElementById("pip").textContent=f):f===h[1]?(f=h[0],C=i,document.getElementById("pip").textContent=f):(f=h[0],C=g,document.getElementById("pip").textContent=f),l(),n()}}function p(){let e,t=0,o=i;f===h[0]?(o=g,e="Player One"):f===h[1]&&(o=i,e="Player Two");for(let e=0;e<o.length;e++)0===o[e].coordinates.length&&++t;console.log(t),5===t&&alert(e+" has won!")}t.createGameboard(),function(){let e=document.querySelectorAll(".cell");for(let t=0;t<e.length;t++)e[t].addEventListener("click",b),e[t].style.backgroundColor="white",e[t].removeEventListener("mouseover",o),e[t].removeEventListener("mouseleave",r),e[t].addEventListener("mouseover",a),e[t].addEventListener("mouseleave",d)}()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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UFosRUFBS0osRUFFTlAsSUFBUUMsRUFBVyxJQUFJVSxFQUFLSCxFQUFjYyxFQUFJLGNBQ3pDdEIsSUFBUUMsRUFBVyxLQUFJVSxFQUFLSixFQUFjZSxFQUFJLGNBQ3RELElBQUksSUFBSXpDLEVBQUcsRUFBRUEsRUFBRThCLEVBQUdSLE9BQU90QixJQUNRLElBQTNCOEIsRUFBRzlCLEdBQUdtQyxZQUFZYixVQUFjb0IsRUFFdEMzQixRQUFRQyxJQUFJMEIsR0FDRCxJQUFSQSxHQUFXQyxNQUFPRixFQUFLLGFBcUsxQmxFLEVBQWdCd0Isa0JBbkpwQixXQUVJLElBQUl3QixFQUFPMUMsU0FBUzJDLGlCQUFpQixTQUN6QyxJQUFJLElBQUl4QixFQUFFLEVBQUVBLEVBQUV1QixFQUFNRCxPQUFPdEIsSUFFM0J1QixFQUFNdkIsR0FBRzZCLGlCQUFpQixRQUFReEMsR0FDbENrQyxFQUFNdkIsR0FBR2pCLE1BQU0yQixnQkFBa0IsUUFDakNhLEVBQU12QixHQUFHNEMsb0JBQW9CLFlBQVkzQyxHQUN6Q3NCLEVBQU12QixHQUFHNEMsb0JBQW9CLGFBQWEzQyxHQUMxQ3NCLEVBQU12QixHQUFHNkIsaUJBQWlCLFlBQVk1QixHQUN0Q3NCLEVBQU12QixHQUFHNkIsaUJBQWlCLGFBQWE1QixHQTRJdkM0QyxJIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYmF0dGxlc2hpcHMvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcHMvd2VicGFjay9ydW50aW1lL2RlZmluZSBwcm9wZXJ0eSBnZXR0ZXJzIiwid2VicGFjazovL2JhdHRsZXNoaXBzL3dlYnBhY2svcnVudGltZS9oYXNPd25Qcm9wZXJ0eSBzaG9ydGhhbmQiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcHMvLi9zcmMvZ2FtZWJvYXJkLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXBzLy4vc3JjL2RvbS5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwcy8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUaGUgcmVxdWlyZSBzY29wZVxudmFyIF9fd2VicGFja19yZXF1aXJlX18gPSB7fTtcblxuIiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gKG9iaiwgcHJvcCkgPT4gKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApKSIsImNvbnN0IEdhbWVib2FyZE1vZHVsZSA9ICgoKSA9PiB7XG5cbiAgICBsZXQgYm9yZCA9IFwic29saWQgYmxhY2sgMnB4XCI7XG4gICAgbGV0IG5vYm9yZCA9IFwibm9uZVwiO1xuICAgIFxuICAgIFxuICAgIGNvbnN0IGNyZWF0ZUdyaWRzID0gKGx0cixubyxpZCkgPT57XG4gICAgbGV0IGdyaWQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpXG4gICAgZ3JpZC5zdHlsZS5wYWRkaW5nID0gXCIxMHB4XCI7XG4gICAgLy90cnlpbmcgdG8gdGFrZSBvdXQgdGhlIGJvcmRlcmluZyBvZiB0aGUgbm90IGluIHBsYXkgY2VsbHNcbiAgICBpZihpZD09PSAwKXtncmlkLnN0eWxlLmJvcmRlcj1ub2JvcmR9XG4gICAgZWxzZSBpZihubz09PTApe2dyaWQuc3R5bGUuYm9yZGVyID0gbm9ib3JkO31cbiAgICBlbHNle2dyaWQuc3R5bGUuYm9yZGVyID0gYm9yZDt9XG4gICAgXG4gICAgXG4gICAgZ3JpZC50ZXh0Q29udGVudCA9IGlkO1xuICAgIGdyaWQuc3R5bGUudGV4dEFsaWduID0gXCJjZW50ZXJcIjtcbiAgICBpZihpZD09PTAgJiYgbHRyPT09XCIwXCIpe2dyaWQudGV4dENvbnRlbnQgPSBub31cbiAgICBlbHNlIGlmKG5vPT09MCAmJiBsdHIhPVwiMFwiKXtncmlkLnRleHRDb250ZW50ID0gbHRyfVxuICAgIGdyaWQuZGF0YXNldC5oaXQgPSBcIk5vXCJcbiAgICBncmlkLmRhdGFzZXQuUDFoaXQ9XCJOXCJcbiAgICBncmlkLmRhdGFzZXQuUDJoaXQ9XCJOXCJcbiAgICBsZXQgbGV0dGVyID0gZ3JpZC5kYXRhc2V0LmxldHRlciA9IGx0cjtcbiAgICBsZXQgbnVtYmVyID0gZ3JpZC5kYXRhc2V0Lm51bWJlciA9IG5vO1xuICAgIC8vc2hvd3Mgd2hpY2ggcGxheWVyIG93bnMgdGhlIGNlbGwvL1xuICAgIC8vbGV0IHBsYXllciA9IGdyaWQuZGF0YXNldC5wbGF5ZXJjZWxsID0gXCJwbGF5ZXJcIitwbHlyO1xuICAgIFxuICAgIC8vY3JlYXRpbmcgYSBjbGFzcyBmb3IgZWFjaCBncmlkIHNvIHdlIGNhbiBhY2Nlc3MgaXQgZnJvbSB0aGUgZnVuY3Rpb25zXG4gICAgZ3JpZC5jbGFzc0xpc3QuYWRkKFwiY2VsbFwiKTtcbiAgICAvL2NyZWF0aW5nIGFuIGlkIHRoYXQgbWF0Y2hlcyBpdHMgY29vcmRpbmF0ZXNcbiAgICBncmlkLnNldEF0dHJpYnV0ZSgnaWQnLGdyaWQuZGF0YXNldC5sZXR0ZXIrZ3JpZC5kYXRhc2V0Lm51bWJlcilcbiAgICBcbiAgICAgICAgIFxuICAgIGxldCBnYW1lYm9hcmQgPSAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJnYW1lYm9hcmQxXCIpO1xuICAgIFxuICAgIGdhbWVib2FyZC5hcHBlbmRDaGlsZChncmlkKTtcbiAgICBcbiAgICB9XG4gICAgXG4gICAgLy9jcmVhdGUgdGhlIHdob2xlIGdyaWQgd2l0aCBiZWxvdyBmdW5jdGlvblxuICAgIGNvbnN0IGNyZWF0ZUdhbWVib2FyZCA9ICgpID0+e1xuICAgIFxuICAgIGZvcihsZXQgaT0wO2k8MTE7aSsrKXtcbiAgICAgICAgXG4gICAgXG4gICAgICAgIEdhbWVib2FyZE1vZHVsZS5jcmVhdGVHcmlkcyhcIjBcIiwwLGkpXG4gICAgICAgIEdhbWVib2FyZE1vZHVsZS5jcmVhdGVHcmlkcyhcIkFcIixpKTtcbiAgICAgICAgR2FtZWJvYXJkTW9kdWxlLmNyZWF0ZUdyaWRzKFwiQlwiLGkpO1xuICAgICAgICBHYW1lYm9hcmRNb2R1bGUuY3JlYXRlR3JpZHMoXCJDXCIsaSk7XG4gICAgICAgIEdhbWVib2FyZE1vZHVsZS5jcmVhdGVHcmlkcyhcIkRcIixpKTtcbiAgICAgICAgR2FtZWJvYXJkTW9kdWxlLmNyZWF0ZUdyaWRzKFwiRVwiLGkpO1xuICAgICAgICBHYW1lYm9hcmRNb2R1bGUuY3JlYXRlR3JpZHMoXCJGXCIsaSk7XG4gICAgICAgIEdhbWVib2FyZE1vZHVsZS5jcmVhdGVHcmlkcyhcIkdcIixpKTtcbiAgICAgICAgR2FtZWJvYXJkTW9kdWxlLmNyZWF0ZUdyaWRzKFwiSFwiLGkpO1xuICAgICAgICBHYW1lYm9hcmRNb2R1bGUuY3JlYXRlR3JpZHMoXCJJXCIsaSk7XG4gICAgICAgIEdhbWVib2FyZE1vZHVsZS5jcmVhdGVHcmlkcyhcIkpcIixpKTtcbiAgICBcbiAgICB9XG4gICAgfVxuICAgIHJldHVybiB7Y3JlYXRlR3JpZHMsY3JlYXRlR2FtZWJvYXJkfVxuICAgIH0pKCk7XG5cbiAgICBleHBvcnR7R2FtZWJvYXJkTW9kdWxlfTsiLCJpbXBvcnQge3NxLGRpcmVjdGlvbixwbGF5ZXIxY29vcmQscGxheWVyMmNvb3JkLHBpcCxwbGF5ZXIxc3RyaWtlcyxwbGF5ZXIyc3RyaWtlcyxwbGF5ZXJCYXNlLFBoaXR9IGZyb20gJy4vaW5kZXgnXG5jb25zdCBkb21Nb2R1bGUgPSAoKCkgPT57XG4vL2Z1bmN0aW9uIGZvciBoaWdobGlnaHRpbmcgc3F1YXJlcyB3aGVuIGhvdmVyaW5nXG5mdW5jdGlvbiBob3Zlcih0KXtcbmxldCBudW1iID0gdC50YXJnZXQuZGF0YXNldC5udW1iZXI7XG5sZXQgbGV0dGVyciA9IHQudGFyZ2V0LmRhdGFzZXQubGV0dGVyO1xubGV0IGNvbG9yID0gXCJibHVlXCI7XG5cbmlmKGRpcmVjdGlvbj09PVwiVlwiKXtcbiAgICBsZXQgb3ZlciA9IDExLXNxO1xuICAgIC8vYnVpbGRpbmcgaXQgc28gd2hlbiB0aGUgdXNlciBzZWxlY3RzIGEgbnVtYmVyIGl0IGtlZXBzIGl0IHdpdGhpbiB0aGUgZ3JpZFxuICAgIGlmKG51bWI+b3Zlcil7bnVtYiA9IG92ZXJ9XG4gICAgaWYobnVtYj09PVwiMFwiKXtjb2xvciA9IFwid2hpdGVcIn1cbiAgICBlbHNle2NvbG9yPVwiZ3JleVwifVxuZm9yKGxldCBpPTA7aTxzcTtpKyspe1xuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobGV0dGVycisoK251bWIraSkpLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGNvbG9yfX1cbmVsc2UgaWYoZGlyZWN0aW9uPT09XCJIXCIpe1xuICAgIGxldCBMdHJOdW1iZXIgPWxldHRlcnIuY2hhckNvZGVBdCgwKVxuICAgIGxldCBvdmVyID0gNzUtc3E7XG4gICAgLy9idWlsZGluZyBpdCBzbyB3aGVuIHRoZSB1c2VyIHNlbGVjdHMgYSBudW1iZXIgaXQga2VlcHMgaXQgd2l0aGluIHRoZSBncmlkXG4gICAgaWYoTHRyTnVtYmVyPm92ZXIpe0x0ck51bWJlciA9IG92ZXJ9XG4gICAgZm9yKGxldCBpPTA7aTxzcTtpKyspe1xuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFN0cmluZy5mcm9tQ2hhckNvZGUoTHRyTnVtYmVyKyspICsgbnVtYikuc3R5bGUuYmFja2dyb3VuZENvbG9yPVwiZ3JleVwifVxufVxufVxuXG4vL2Z1bmN0aW9uIGZvciByZXR1cm5pbmcgc3F1YXJlIGNvbG9yIHRvIHdoaXRlIGFmdGVyIGxlYXZpbmdcbmZ1bmN0aW9uIGxlYXZlKHQpe3QudGFyZ2V0LmJhY2tncm91bmRDb2xvcj1cIndoaXRlXCJcbmxldCBudW1iID0gdC50YXJnZXQuZGF0YXNldC5udW1iZXI7XG5sZXQgbGV0dGVyciA9IHQudGFyZ2V0LmRhdGFzZXQubGV0dGVyO1xubGV0IGhpdCA9IGxldHRlcnIrbnVtYjtcbmNvbnNvbGUubG9nKGhpdCk7XG5cbmlmKGRpcmVjdGlvbj09PVwiVlwiKXtcbiAgICBsZXQgb3ZlciA9IDExLXNxO1xuICAgIC8vYnVpbGRpbmcgaXQgc28gd2hlbiB0aGUgdXNlciBzZWxlY3RzIGEgbnVtYmVyIGl0IGtlZXBzIGl0IHdpdGhpbiB0aGUgZ3JpZFxuICAgIGlmKG51bWI+b3Zlcil7bnVtYiA9IG92ZXJ9XG4gICAgZm9yKGxldCBpPTA7aTxzcTtpKyspe1xuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGxldHRlcnIrKCtudW1iK2kpKS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcIndoaXRlXCJ9fVxuICAgIGVsc2UgaWYoZGlyZWN0aW9uPT09XCJIXCIpe1xuICAgICAgICBsZXQgTHRyTnVtYmVyID1sZXR0ZXJyLmNoYXJDb2RlQXQoMClcbiAgICAgICAgbGV0IG92ZXIgPSA3NS1zcTtcbiAgICAgICAgXG4gICAgLy9idWlsZGluZyBpdCBzbyB3aGVuIHRoZSB1c2VyIHNlbGVjdHMgYSBudW1iZXIgaXQga2VlcHMgaXQgd2l0aGluIHRoZSBncmlkXG4gICAgaWYoTHRyTnVtYmVyPm92ZXIpe0x0ck51bWJlciA9IG92ZXJ9XG4gICAgICAgIGZvcihsZXQgaT0wO2k8c3E7aSsrKXtcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoU3RyaW5nLmZyb21DaGFyQ29kZShMdHJOdW1iZXIrKykgKyBudW1iKS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3I9XCJ3aGl0ZVwifVxuICAgIH1cblxuICAgIFxuICAgIH1cblxuICAgIC8vcmVtZW1iZXIgdG8gaW1wbGVtZW50IHRoaXMgYmVmb3JlIGZpbmlzaGluZyB1cCB0aGUgcHJvamVjdFxuICAgIC8vKioqXG4gICAgZnVuY3Rpb24gc2hvd0Nvb3JkcCgpe1xuICAgIGZvcihsZXQgaT0wO2k8cGxheWVyMWNvb3JkLmxlbmd0aDtpKyspe1xuICAgICAgICBsZXQgcCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJwXCIpXG4gICAgICAgIHAudGV4dENvbnRlbnQgPSBwbGF5ZXIxY29vcmRbaV0ubmFtZSArJy0nK3BsYXllcjFjb29yZFtpXS5jb29yZGluYXRlcztcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwMWNcIikuYXBwZW5kQ2hpbGQocCk7XG4gICAgICB9XG5cbiAgICAgIGZvcihsZXQgaT0wO2k8cGxheWVyMmNvb3JkLmxlbmd0aDtpKyspe1xuICAgICAgICBsZXQgcCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJwXCIpXG4gICAgICAgIHAudGV4dENvbnRlbnQgPSBwbGF5ZXIyY29vcmRbaV0ubmFtZSArJy0nK3BsYXllcjJjb29yZFtpXS5jb29yZGluYXRlcztcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwMmNcIikuYXBwZW5kQ2hpbGQocCk7XG4gICAgICB9fVxuICAgXG4gICAgICAvL2Z1bmN0aW9uIHRoYXQgYWxsb3dzIHVzIHRvIHVwZGF0ZSB0aWxlcyB3aXRob3V0IGNhcnJ5aW5nIHByZXZpb3VzIHRpbGVzIG92ZXJcbiAgICAgIGZ1bmN0aW9uIHdoaXRlT3V0KCl7XG4gICAgICAgIGxldCBjZWxscz0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5jZWxsXCIpO1xuICAgICAgICBmb3IobGV0IGk9MDtpPGNlbGxzLmxlbmd0aDtpKyspe1xuICAgICAgICAgICAgY2VsbHNbaV0uc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCJ3aGl0ZVwiO31cbiAgICAgIH1cbiAgICBcbiAgICBmdW5jdGlvbiBhdHRhY2tCb2FyZCgpe1xuICAgICAgICBsZXQgc3RyaWtlID0gcGxheWVyMXN0cmlrZXM7XG4gICAgICAgIGlmKHBpcCA9PT0gcGxheWVyQmFzZVswXSl7c3RyaWtlPXBsYXllcjFzdHJpa2VzfVxuICAgIGVsc2UgaWYocGlwID09PSBwbGF5ZXJCYXNlWzFdKXtzdHJpa2U9cGxheWVyMnN0cmlrZXN9ICAgIFxuICAgIGZvcihsZXQgaT0wO2k8c3RyaWtlLmxlbmd0aDtpKyspe1xuICAgICAgICBjb25zb2xlLmxvZyhzdHJpa2VbaV0pXG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHN0cmlrZVtpXSkuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCJyZWRcIjtcbiAgICB9XG5cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBwbGF5ZXJCb2FyZCgpe1xuICAgICAgICBcbiAgICB9XG5cbiAgICAvL2Z1bmN0aW9ucyBmb3Igd2hlbiB0aGUgaGl0IGZ1bmN0aW9uIGlzIGluIHBsYXlcbiAgICBmdW5jdGlvbiBoaXRIb3Zlcih0KXtcbiAgICAgICAgaWYodC50YXJnZXQuZGF0YXNldC5udW1iZXI9PT1cIjBcIilcbnt0LnRhcmdldC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3I9XCJ3aGl0ZVwifWVsc2V7dC50YXJnZXQuc3R5bGUuYmFja2dyb3VuZENvbG9yPVwicmVkXCJ9XG5cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBoaXRMZWF2ZSh0KXtcbiAgICAgICAgaWYocGlwID09PSBwbGF5ZXJCYXNlWzBdKXtQaGl0PXQudGFyZ2V0LmRhdGFzZXQuUDFoaXR9XG4gICAgZWxzZSBpZihwaXAgPT09IHBsYXllckJhc2VbMV0pe1BoaXQ9dC50YXJnZXQuZGF0YXNldC5QMmhpdH0gIFxuICAgIGNvbnNvbGUubG9nKFBoaXQpXG4gICAgICAgIGlmKFBoaXQ9PT1cIllcIil7dC50YXJnZXQuc3R5bGUuYmFja2dyb3VuZENvbG9yPVwicmVkXCJ9XG4gICAgICAgIGVsc2UgaWYoUGhpdD09PVwiTlwiKXt0LnRhcmdldC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcIndoaXRlXCJ9XG4gICAgfVxuXG5yZXR1cm4ge2hvdmVyLGxlYXZlLHNob3dDb29yZHAsYXR0YWNrQm9hcmQsd2hpdGVPdXQsaGl0SG92ZXIsaGl0TGVhdmV9XG59KSgpO1xuXG5cbmV4cG9ydHtkb21Nb2R1bGV9IiwiaW1wb3J0IHtHYW1lYm9hcmRNb2R1bGV9IGZyb20gJy4vZ2FtZWJvYXJkJ1xuaW1wb3J0IHtjYXJyaWVyLGJhdHRsZXNoaXAsY3J1aXNlcixzdWJtYXJpbmUsZGVzdHJveWVyfSBmcm9tICcuL3NoaXBzJ1xuaW1wb3J0IHtkb21Nb2R1bGV9IGZyb20gJy4vZG9tJ1xuXG5cbiAgLy9jb29yZGluYXRlcyBvZiBlYWNoIHBsYXllcnMgc2hpcFxuICBsZXQgcGxheWVyMWNvb3JkPVtdO1xuICBsZXQgcGxheWVyMmNvb3JkPVtdO1xuICAvL2Ftb3VudCBvZiBzdW5rIHNoaXBzIGRldGVybWluaW5nIHdoZXRoZXIgdGhlIGdhbWUgaXMgb3ZlciBvciBub3RcbiAgbGV0IHBsYXllcjFTdW5rU2hpcHM9MDtcbiAgbGV0IHBsYXllcjJTdW5rU2hpcHM9MDtcbiAgLy9jb29yZGluYXRlcyBvZiBlYWNoIHRpbGUgaGl0IGJ5IGVhY2ggcGxheWVyXG4gIGxldCBwbGF5ZXIxc3RyaWtlcz1bXVxuICBsZXQgcGxheWVyMnN0cmlrZXM9W11cbiAgLy9WPVZlcnRpY2FsLCBIPUhvcml6b250YWxcbiAgbGV0IGRpcmVjdGlvbiA9IFwiVlwiXG4gIC8vcGxheWVyIGluIHBsYXlcbiAgbGV0IHBsYXllckJhc2UgPSBbXCJwbGF5ZXIxXCIsXCJwbGF5ZXIyXCJdO1xuICBsZXQgcGlwID0gcGxheWVyQmFzZVswXTtcbiAgbGV0IFBjcmQgPSBwbGF5ZXIxY29vcmQ7XG4gIGlmKHBpcCA9PT0gcGxheWVyQmFzZVswXSl7UGNyZCA9IHBsYXllcjFjb29yZDt9XG4gIGVsc2UgaWYocGlwID09PSBwbGF5ZXJCYXNlWzFdKXtQY3JkID0gcGxheWVyMmNvb3JkO31cbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwaXBcIikudGV4dENvbnRlbnQgPSBwaXA7XG4gIC8vdGhlIHNxdWFyZXMgdGhhdCBuZWVkIGhpZ2hsaWdodGluZyBmb3IgdGhlIGRvbVxuICBsZXQgc3E7XG4gIGxldCBQaGl0O1xuXG5cbiAgXG4gIFxuXG4vL2J1dHRvbiB0byBjaGFuZ2UgdGhlIHBvc2l0aW9uaW5nIG9mIHRoZSBwbGFjZW1lbnRcbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiQ2huZ2VcIikuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCgpPT57aWYoZGlyZWN0aW9uPT09XCJWXCIpe2RpcmVjdGlvbj1cIkhcIjtkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInBvc2l0aW9uXCIpLnRleHRDb250ZW50PVwiSG9yaXpvbnRhbFwiO31lbHNlIGlmKGRpcmVjdGlvbj09PVwiSFwiKXtkaXJlY3Rpb249XCJWXCI7ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwb3NpdGlvblwiKS50ZXh0Q29udGVudD1cIlZlcnRpY2FsXCJ9fSlcbi8vYXR0YWNrYm9hcmQgYnV0dG9uIHRoYXQgc2hvd3MgcG9zaXRpb25zIHdoZXJlIHRoZSBwbGF5ZXIgaGFzIGF0dGFja2VkXG5kb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInNod3NoaXBvc1wiKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsZG9tTW9kdWxlLmF0dGFja0JvYXJkKVxuXG4vL2Z1bmN0aW9uIGNoYW5nZXMgcGxheWVyXG5jb25zdCBjaGFuUGxheWVyID0gKCk9PntcbiAgICBpZihwaXAgPT09IHBsYXllckJhc2VbMF0pe3BpcCA9IHBsYXllckJhc2VbMV07XG4gICAgICAgIFBjcmQgPSBwbGF5ZXIyY29vcmQ7XG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicGlwXCIpLnRleHRDb250ZW50ID0gcGlwO31cbiAgICBlbHNlIGlmKHBpcCA9PT0gcGxheWVyQmFzZVsxXSl7cGlwID0gcGxheWVyQmFzZVswXTtcbiAgICAgICAgUGNyZCA9IHBsYXllcjFjb29yZDtcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwaXBcIikudGV4dENvbnRlbnQgPSBwaXA7fVxuICAgIGVsc2V7cGlwID0gcGxheWVyQmFzZVswXTtcbiAgICAgICAgUGNyZD1wbGF5ZXIyY29vcmQ7XG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicGlwXCIpLnRleHRDb250ZW50ID0gcGlwO31cbiAgICAgICAgZG9tTW9kdWxlLndoaXRlT3V0KCk7XG4gICAgICAgIGRvbU1vZHVsZS5hdHRhY2tCb2FyZCgpO1xuXG59XG5cblxuLy9iZWxvdyBmdW5jdGlvbnMgbmVlZCB0byBiZSBncm91cGVkIGludG8gYSBtb2R1bGVcblxuZnVuY3Rpb24gaGl0KHQpe2NvbnNvbGUubG9nKHQudGFyZ2V0LmRhdGFzZXQubGV0dGVyKTtcbiAgICBsZXQgUEMgPSBwbGF5ZXIxY29vcmQ7XG4gICAgbGV0IHN0cmlrZSA9IHBsYXllcjFzdHJpa2VzO1xuICAgIGxldCBMID0gdC50YXJnZXQuZGF0YXNldC5sZXR0ZXI7XG4gICAgbGV0IE4gPSB0LnRhcmdldC5kYXRhc2V0Lm51bWJlcjtcbiAgICAgbGV0IGhpdENvb3JkID0gTCtOO1xuICAgIGNvbnNvbGUubG9nKGhpdENvb3JkKTtcbiAgICBjb25zb2xlLmxvZyhQQy5sZW5ndGgpOyBcbiAgICBpZihwaXAgPT09IHBsYXllckJhc2VbMF0pe1BDID0gcGxheWVyMmNvb3JkO3N0cmlrZT1wbGF5ZXIxc3RyaWtlcztQaGl0PXQudGFyZ2V0LmRhdGFzZXQuUDFoaXR9XG4gICAgZWxzZSBpZihwaXAgPT09IHBsYXllckJhc2VbMV0pe1BDID0gcGxheWVyMWNvb3JkO3N0cmlrZT1wbGF5ZXIyc3RyaWtlcztQaGl0PXQudGFyZ2V0LmRhdGFzZXQuUDJoaXR9XG4gICAgaWYoTj09PVwiMFwiKXtjb25zb2xlLmxvZyhcIlN0YXkgaW4gdGhlIGdyaWQuXCIpfVxuICAgIGVsc2UgaWYoUGhpdD09PVwiWVwiKXtjb25zb2xlLmxvZyhcIkFscmVhZHkgYmVlbiBoaXQsIHRyeSBhZ2Fpbi5cIil9XG4gICAgZWxzZXsgICAgICAgXG4gICAgICAgIGlmKHBpcCA9PT0gcGxheWVyQmFzZVswXSl7UEMgPSBwbGF5ZXIyY29vcmQ7c3RyaWtlPXBsYXllcjFzdHJpa2VzO1BoaXQ9dC50YXJnZXQuZGF0YXNldC5QMWhpdD1cIllcIn1cbiAgICAgICAgZWxzZSBpZihwaXAgPT09IHBsYXllckJhc2VbMV0pe1BDID0gcGxheWVyMWNvb3JkO3N0cmlrZT1wbGF5ZXIyc3RyaWtlcztQaGl0PXQudGFyZ2V0LmRhdGFzZXQuUDJoaXQ9XCJZXCJ9XG4gICAgZm9yKGxldCBwPTA7cDxQQy5sZW5ndGg7cCsrKXtcbiAgICAgICAgZm9yKGxldCBpPTA7aTxQQ1twXS5jb29yZGluYXRlcy5sZW5ndGg7aSsrKXtcbiAgICAgICAgaWYoUENbcF0uY29vcmRpbmF0ZXNbaV09PT1oaXRDb29yZCl7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhQQ1twXS5jb29yZGluYXRlcylcbiAgICAgICAgICAgIFBDW3BdLmNvb3JkaW5hdGVzLnNwbGljZShpLDEpXG4gICAgICAgIFBDW3BdLmhpdFNoaXAoKTtcbiAgICAgICAgUENbcF0uaXNTdW5rKCk7ICAgIFxuICAgICAgICBcbiAgICAgICAgZ2FtZU92ZXIoKTtcbiAgICAgICAgY29uc29sZS5sb2coUENbcF0uY29vcmRpbmF0ZXMpXG4gICAgICAgIGNvbnNvbGUubG9nKFwiUGxheWVyIG9uZSBzdW5rIHNoaXBzOiBcIisgcGxheWVyMVN1bmtTaGlwcykgIFxuICAgICAgICBjb25zb2xlLmxvZyhcIlBsYXllciB0d28gc3VuayBzaGlwczogXCIrIHBsYXllcjJTdW5rU2hpcHMpICBcbiAgICAgICAgXG4gICAgICAgIH19XG4gICAgfXN0cmlrZS5wdXNoKGhpdENvb3JkKSAgICBcbiAgICAgICAgY29uc29sZS5sb2coXCJQMSBzdHJpa2VzOiBcIisgcGxheWVyMXN0cmlrZXMpXG4gICAgICAgIGNvbnNvbGUubG9nKFwiUDIgc3RyaWtlczogXCIrIHBsYXllcjJzdHJpa2VzKVxuICAgICAgICBcbiAgICBjaGFuUGxheWVyKCl9fVxuXG5cbiBmdW5jdGlvbiBnYW1lT3Zlcigpe1xuICAgIGxldCBjb3VudCA9MDtcbiAgICBsZXQgUEMgPSBwbGF5ZXIxY29vcmQ7XG4gICAgbGV0IHBscjtcbiAgICBpZihwaXAgPT09IHBsYXllckJhc2VbMF0pe1BDID0gcGxheWVyMmNvb3JkOyBwbHI9XCJQbGF5ZXIgT25lXCJ9XG4gICAgZWxzZSBpZihwaXAgPT09IHBsYXllckJhc2VbMV0pe1BDID0gcGxheWVyMWNvb3JkOyBwbHI9XCJQbGF5ZXIgVHdvXCJ9XG4gICAgZm9yKGxldCBpID0wO2k8UEMubGVuZ3RoO2krKyl7XG4gICAgICAgaWYoUENbaV0uY29vcmRpbmF0ZXMubGVuZ3RoPT09MCl7Kytjb3VudH1cbiAgICB9XG4gICAgY29uc29sZS5sb2coY291bnQpO1xuICAgIGlmKGNvdW50PT09NSl7YWxlcnQoIHBscisgXCIgaGFzIHdvbiFcIil9XG4gICAgfVxuICAgIFxuXG5mdW5jdGlvbiBzdGFydEdhbWUoKXtcbiAgICBpZihQY3JkLmxlbmd0aD40KXtcbiAgICBzcT0xXG4gICAgY2hhblBsYXllcigpO1xuICAgIGxldCBjZWxscz0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5jZWxsXCIpO1xuZm9yKGxldCBpPTA7aTxjZWxscy5sZW5ndGg7aSsrKXtcbiAgICBjZWxsc1tpXS5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsZGVzdHJveWVyKSBcbmNlbGxzW2ldLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJyxzdGFydEdhbWUpXG5jZWxsc1tpXS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcIndoaXRlXCI7XG5kb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImluZ2FtZWJ1dHRvbnNcIikuc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcbn1cbnBsYXlHYW1lKCl9fVxuICAgIFxuICAgIFxuZnVuY3Rpb24gcGxheUdhbWUoKXtcbiAgICBcbiAgICBsZXQgY2VsbHM9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuY2VsbFwiKTtcbmZvcihsZXQgaT0wO2k8Y2VsbHMubGVuZ3RoO2krKyl7XG5cbmNlbGxzW2ldLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJyxoaXQpXG5jZWxsc1tpXS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcIndoaXRlXCI7XG5jZWxsc1tpXS5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZW92ZXInLGRvbU1vZHVsZS5ob3ZlcilcbmNlbGxzW2ldLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLGRvbU1vZHVsZS5sZWF2ZSlcbmNlbGxzW2ldLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlb3ZlcicsZG9tTW9kdWxlLmhpdEhvdmVyKVxuY2VsbHNbaV0uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsZG9tTW9kdWxlLmhpdExlYXZlKVxuXG5cbn1cbn1cblxuXG5cbi8vU2VsZWN0aW9uIG1vZHVsZVxuY29uc3Qgc2VsZWN0aW9uTW9kdWxlID0gKCgpID0+e1xuICAgIFxuICAgIFxuXG4gICAgICAgIFxuICAgIC8vYWRkcyBhbiBldmVudCBsaXN0ZW5lciB0byBldmVyeSBncmlkIGNlbGwgYWxsb3dpbmcgdXMgdG8gY2hvb3NlIG91ciBjb29yZGluYXRlcyxtYXAgdGhlbSB0byB0aGUgYXJyYXkgdGhlbiBjaGFuZ2UgcGxheWVyXG4gICAgZnVuY3Rpb24gcDFjYXJyaWVyU2hpcCgpe1xuICAgICAgIFxuICAgICAgICBsZXQgY2VsbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmNlbGxcIilcbiAgICAgICAgLy9zcSBpcyBjb250cm9sbGluZyB0aGUgaGlnaGxpZ2h0aW5nIG51bWJlclxuICAgICAgICBzcT0yO1xuICAgICAgICBmb3IobGV0IGk9MDtpPGNlbGxzLmxlbmd0aDtpKyspe1xuICAgICAgICAgICAgY2VsbHNbaV0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLGNhcnJpZXIpIFxuICAgICAgICAgICAgY2VsbHNbaV0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLHNlbGVjdGlvbk1vZHVsZS5wMWJhdHRsZVNoaXApIFxuICAgICAgICAgICAgY2VsbHNbaV0uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VvdmVyJyxkb21Nb2R1bGUuaG92ZXIpXG4gICAgICAgIGNlbGxzW2ldLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLGRvbU1vZHVsZS5sZWF2ZSlcbiAgICAgICAgfVxuICAgICAgICB9XG4gICAgZnVuY3Rpb24gcDFiYXR0bGVTaGlwKCl7ICAgXG5cbiAgICAgICAgaWYoUGNyZC5sZW5ndGg+MCl7XG4gICAgICAgIFxuICAgICAgICBsZXQgY2VsbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmNlbGxcIilcbiAgICAgICAgXG4gICAgICAgIC8vc3EgaXMgY29udHJvbGxpbmcgdGhlIGhpZ2hsaWdodGluZyBudW1iZXJcbiAgICAgICAgc3E9MztcbiAgICAgICAgZm9yKGxldCBpPTA7aTxjZWxscy5sZW5ndGg7aSsrKXtcbiAgICAgICAgICAgIGNlbGxzW2ldLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJyxjYXJyaWVyKSBcbiAgICAgICAgICAgIGNlbGxzW2ldLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJyxzZWxlY3Rpb25Nb2R1bGUucDFiYXR0bGVTaGlwKSBcbiAgICAgICAgICAgIGNlbGxzW2ldLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJyxiYXR0bGVzaGlwKSBcbiAgICAgICAgICAgIC8vaWYgY29vcmRpbmF0ZXMgbWF0Y2ggbGVuZ3RoIG5lZWRlZCBtb3ZlIG9udG8gbmV4dCBwYXJ0XG4gICAgICAgICAgICBjZWxsc1tpXS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsc2VsZWN0aW9uTW9kdWxlLnAxY3J1aXNlclNoaXApIFxuICAgICAgICAgICAgY2VsbHNbaV0uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VvdmVyJyxkb21Nb2R1bGUuaG92ZXIpXG4gICAgICAgIGNlbGxzW2ldLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLGRvbU1vZHVsZS5sZWF2ZSlcbiAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIFxuXG4gICAgZnVuY3Rpb24gcDFjcnVpc2VyU2hpcCgpe1xuXG4gICAgICAgIGlmKFBjcmQubGVuZ3RoPjEpe1xuICAgICAgICAgICAgXG4gICAgICAgIFxuICAgICAgICBjb25zb2xlLmxvZyhQY3JkKVxuICAgICAgICBsZXQgY2VsbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmNlbGxcIilcbiAgICAgICAgXG4gICAgICAgIC8vc3EgaXMgY29udHJvbGxpbmcgdGhlIGhpZ2hsaWdodGluZyBudW1iZXJcbiAgICAgICAgc3E9NDtcbiAgICAgICAgZm9yKGxldCBpPTA7aTxjZWxscy5sZW5ndGg7aSsrKXtcbiAgICAgICAgICAgIGNlbGxzW2ldLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJyxiYXR0bGVzaGlwKSBcbiAgICAgICAgICAgIGNlbGxzW2ldLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJyxzZWxlY3Rpb25Nb2R1bGUucDFjcnVpc2VyU2hpcCkgXG4gICAgICAgICAgICBjZWxsc1tpXS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsY3J1aXNlcikgXG4gICAgICAgICAgICBjZWxsc1tpXS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsc2VsZWN0aW9uTW9kdWxlLnAxc3VibWFyaW5lU2hpcCkgXG4gICAgICAgICAgICBjZWxsc1tpXS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW92ZXInLGRvbU1vZHVsZS5ob3ZlcilcbiAgICAgICAgY2VsbHNbaV0uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsZG9tTW9kdWxlLmxlYXZlKVxuICAgICAgICB9XG4gICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHAxc3VibWFyaW5lU2hpcCgpe1xuXG4gICAgICAgIGlmKFBjcmQubGVuZ3RoPjIpe1xuICAgICAgICBcbiAgICAgICAgbGV0IGNlbGxzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5jZWxsXCIpXG4gICAgICAgIFxuICAgICAgICAvL3NxIGlzIGNvbnRyb2xsaW5nIHRoZSBoaWdobGlnaHRpbmcgbnVtYmVyXG4gICAgICAgIHNxPTU7XG4gICAgICAgIGZvcihsZXQgaT0wO2k8Y2VsbHMubGVuZ3RoO2krKyl7XG4gICAgICAgICAgICBjZWxsc1tpXS5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsY3J1aXNlcikgXG4gICAgICAgICAgICBjZWxsc1tpXS5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsc2VsZWN0aW9uTW9kdWxlLnAxc3VibWFyaW5lU2hpcCkgXG4gICAgICAgICAgICBjZWxsc1tpXS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsc3VibWFyaW5lKSBcbiAgICAgICAgICAgIGNlbGxzW2ldLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJyxzZWxlY3Rpb25Nb2R1bGUucDFkZXN0cm95ZXJTaGlwKSBcbiAgICAgICAgICAgIGNlbGxzW2ldLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlb3ZlcicsZG9tTW9kdWxlLmhvdmVyKVxuICAgICAgICBjZWxsc1tpXS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJyxkb21Nb2R1bGUubGVhdmUpXG4gICAgICAgIH1cbiAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcDFkZXN0cm95ZXJTaGlwKCl7XG5cbiAgICAgICAgaWYoUGNyZC5sZW5ndGg+Myl7XG4gICAgICAgIGxldCBjZWxscyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuY2VsbFwiKVxuICAgICAgICBcbiAgICAgICAgLy9zcSBpcyBjb250cm9sbGluZyB0aGUgaGlnaGxpZ2h0aW5nIG51bWJlclxuICAgICAgICBzcT02O1xuICAgICAgICBmb3IobGV0IGk9MDtpPGNlbGxzLmxlbmd0aDtpKyspe1xuICAgICAgICAgICAgY2VsbHNbaV0ucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLHN1Ym1hcmluZSkgXG4gICAgICAgICAgICBjZWxsc1tpXS5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsc2VsZWN0aW9uTW9kdWxlLnAxZGVzdHJveWVyU2hpcCkgXG4gICAgICAgICAgICBjZWxsc1tpXS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsZGVzdHJveWVyKSBcbiAgICAgICAgICAgIC8vdGhpcyBkZWNpZGVzIHdoZXRoZXIgdGhlIGdhbWUgc3RhcnRzIGFmdGVyIHBsYXllciB0d28gb3IgdGhlIGNvbXB1dGVyIGhhcyBzZWxlY3RlZCB0aGVpciBncmlkc1xuICAgICAgICAgICAgLy9pZiBub3QgaXQgbG9vcHMgYXJvdW5kXG4gICAgICAgICAgICBpZihwaXAgPT09IHBsYXllckJhc2VbMV0pe2NlbGxzW2ldLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJyxzdGFydEdhbWUpfVxuICAgICAgIGVsc2UgaWYocGlwID09PSBwbGF5ZXJCYXNlWzBdKXtjZWxsc1tpXS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsc2VsZWN0aW9uTW9kdWxlLmxvb3ApIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY2VsbHNbaV0uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VvdmVyJyxkb21Nb2R1bGUuaG92ZXIpXG4gICAgICAgIGNlbGxzW2ldLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLGRvbU1vZHVsZS5sZWF2ZSlcbiAgICAgICAgfVxuICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBsb29wKCl7XG4gICAgICAgIGlmKFBjcmQubGVuZ3RoPjQpe1xuXG4gICAgICAgIC8vVGhpcyBmdW5jdGlvbiB0dXJucyB0aGUgc2VsZWN0aW9uIHByb2Nlc3Mgb3ZlciB0byBlaXRoZXIgYSBjb21wdXRlciBvciBwbGF5ZXIgMlxuICAgIC8vanVzdCBkb2luZyBwbGF5ZXIgMiBpbXBsZW1ldGF0aW9uIGZvciBub3dcbiAgICBjaGFuUGxheWVyKCk7XG4gICAgICAgIGxldCBjZWxscyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuY2VsbFwiKVxuICAgIFxuICAgICAgICBmb3IobGV0IGk9MDtpPGNlbGxzLmxlbmd0aDtpKyspe1xuICAgICAgICAgICAgY2VsbHNbaV0ucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLGRlc3Ryb3llcikgXG4gICAgICAgICAgICBjZWxsc1tpXS5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsc2VsZWN0aW9uTW9kdWxlLmxvb3ApIFxuICAgICAgICAgICAgY2VsbHNbaV0uc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCJ3aGl0ZVwiO1xuICAgIH1cbnNlbGVjdGlvbk1vZHVsZS5wMWNhcnJpZXJTaGlwKCk7XG59XG4gICAgfVxuXG5cbiAgICBcbiAgICAgICAgcmV0dXJue3AxY2FycmllclNoaXAscDFiYXR0bGVTaGlwLHAxY3J1aXNlclNoaXAscDFzdWJtYXJpbmVTaGlwLHAxZGVzdHJveWVyU2hpcCxsb29wfVxuICAgIFxuICAgIH0pKCk7XG5cblxuXG5cblxuICAgIEdhbWVib2FyZE1vZHVsZS5jcmVhdGVHYW1lYm9hcmQoKTtcbi8vc2VsZWN0aW9uTW9kdWxlLnAxY2FycmllclNoaXAoKTtcbi8vdGVzdGluZyBoaXQgZnVuY3Rpb25cbnBsYXlHYW1lKCk7XG5cblxuZXhwb3J0IHtQaGl0LHNxLGRpcmVjdGlvbixwaXAscGxheWVyMWNvb3JkLHBsYXllcjJjb29yZCxwbGF5ZXJCYXNlLGNoYW5QbGF5ZXIscGxheWVyMVN1bmtTaGlwcyxwbGF5ZXIyU3Vua1NoaXBzLHBsYXllcjFzdHJpa2VzLHBsYXllcjJzdHJpa2VzfVxuXG5cblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcblxuIl0sIm5hbWVzIjpbIl9fd2VicGFja19yZXF1aXJlX18iLCJleHBvcnRzIiwiZGVmaW5pdGlvbiIsImtleSIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJvYmoiLCJwcm9wIiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiR2FtZWJvYXJkTW9kdWxlIiwiY3JlYXRlR3JpZHMiLCJsdHIiLCJubyIsImlkIiwiZ3JpZCIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsInN0eWxlIiwicGFkZGluZyIsImJvcmRlciIsInRleHRDb250ZW50IiwidGV4dEFsaWduIiwiZGF0YXNldCIsImhpdCIsIlAxaGl0IiwiUDJoaXQiLCJsZXR0ZXIiLCJudW1iZXIiLCJjbGFzc0xpc3QiLCJhZGQiLCJzZXRBdHRyaWJ1dGUiLCJnZXRFbGVtZW50QnlJZCIsImFwcGVuZENoaWxkIiwiY3JlYXRlR2FtZWJvYXJkIiwiaSIsImRvbU1vZHVsZSIsInQiLCJudW1iIiwidGFyZ2V0IiwibGV0dGVyciIsImNvbG9yIiwiZGlyZWN0aW9uIiwib3ZlciIsInNxIiwiYmFja2dyb3VuZENvbG9yIiwiTHRyTnVtYmVyIiwiY2hhckNvZGVBdCIsIlN0cmluZyIsImZyb21DaGFyQ29kZSIsImNvbnNvbGUiLCJsb2ciLCJzdHJpa2UiLCJwbGF5ZXIxc3RyaWtlcyIsInBpcCIsInBsYXllckJhc2UiLCJwbGF5ZXIyc3RyaWtlcyIsImxlbmd0aCIsImNlbGxzIiwicXVlcnlTZWxlY3RvckFsbCIsIlBoaXQiLCJwbGF5ZXIxY29vcmQiLCJwbGF5ZXIyY29vcmQiLCJQY3JkIiwiYWRkRXZlbnRMaXN0ZW5lciIsIlBDIiwiTCIsIk4iLCJoaXRDb29yZCIsInAiLCJjb29yZGluYXRlcyIsInNwbGljZSIsImhpdFNoaXAiLCJpc1N1bmsiLCJnYW1lT3ZlciIsInB1c2giLCJwbHIiLCJjb3VudCIsImFsZXJ0IiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInBsYXlHYW1lIl0sInNvdXJjZVJvb3QiOiIifQ==