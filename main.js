(()=>{"use strict";var e={d:(t,r)=>{for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{o7:()=>h,P4:()=>y,VL:()=>g,yR:()=>p,w7:()=>v,sq:()=>m});const t={createGrids:(e,t,r)=>{let n=document.createElement("div");n.style.padding="10px",n.style.border=0===r||0===t?"none":"solid black 2px",n.textContent=r,n.style.textAlign="center",0===r&&"0"===e?n.textContent=t:0===t&&"0"!=e&&(n.textContent=e),n.dataset.hit="No",n.dataset.hit,n.dataset.letter=e,n.dataset.number=t,n.classList.add("cell"),n.setAttribute("id",n.dataset.letter+n.dataset.number),document.getElementById("gameboard1").appendChild(n)},createGameboard:()=>{for(let e=0;e<11;e++)t.createGrids("0",0,e),t.createGrids("A",e),t.createGrids("B",e),t.createGrids("C",e),t.createGrids("D",e),t.createGrids("E",e),t.createGrids("F",e),t.createGrids("G",e),t.createGrids("H",e),t.createGrids("I",e),t.createGrids("J",e)}};function r(e,t,r,n){let l=[];if("V"===n){let n=11-r;t>n&&(t=n);for(let n=1;n<r+1;n++)l.push(e+t++)}else if("H"===n){let n=e.charCodeAt(0),o=75-r;n>o&&(n=o),console.log(n),console.log(o);for(let e=1;e<r+1;e++)l.push(String.fromCharCode(n++)+t)}return l}function n(e,t){this.name=e,this.coordinates=t,this.hitShip=()=>{alert("You struck the "+e+" ship")},this.isSunk=()=>{0===t.length&&alert("You sunk the "+e+" ship")}}let l;const o=e=>{e.target.style.backgroundColor="red";let t,o=e.target.dataset.letter,a=e.target.dataset.number,c=new n("Carrier",r(o,a,2,h));y===v[0]?(t=g,l="p1c"):y===v[1]&&(t=p,l="p2c"),t.push(c);let d=document.createElement("p");return d.textContent="Carrier-"+r(o,a,2,h),document.getElementById(l).appendChild(d),t},a=e=>{e.target.style.backgroundColor="red";let t,o=e.target.dataset.letter,a=e.target.dataset.number,c=new n("Battleship",r(o,a,3,h));y===v[0]?(t=g,l="p1c"):y===v[1]&&(t=p,l="p2c"),t.push(c);let d=document.createElement("p");return d.textContent="BattleShip-"+r(o,a,3,h),document.getElementById(l).appendChild(d),t},c=e=>{e.target.style.backgroundColor="red";let t,o=e.target.dataset.letter,a=e.target.dataset.number,c=new n("Cruiser",r(o,a,4,h));y===v[0]?(t=g,l="p1c"):y===v[1]&&(t=p,l="p2c"),t.push(c);let d=document.createElement("p");return d.textContent="Cruiser-"+r(o,a,4,h),document.getElementById(l).appendChild(d),t},d=e=>{e.target.style.backgroundColor="red";let t,o=e.target.dataset.letter,a=e.target.dataset.number,c=new n("Submarine",r(o,a,5,h));y===v[0]?(t=g,l="p1c"):y===v[1]&&(t=p,l="p2c"),t.push(c);let d=document.createElement("p");return d.textContent="Submarine-"+r(o,a,5,h),document.getElementById(l).appendChild(d),t},i=e=>{e.target.style.backgroundColor="red";let t,o=e.target.dataset.letter,a=e.target.dataset.number,c=new n("Destroyer",r(o,a,6,h));y===v[0]?(t=g,l="p1c"):y===v[1]&&(t=p,l="p2c"),t.push(c);let d=document.createElement("p");return d.textContent="Destroyer-"+r(o,a,6,h),document.getElementById(l).appendChild(d),t},s=function(e){e.target.style.backgroundColor="green";let t=e.target.dataset.number,r=e.target.dataset.letter;if("V"===h){let e=11-m;t>e&&(t=e);for(let e=0;e<m;e++)document.getElementById(r+(+t+e)).style.backgroundColor="grey"}else if("H"===h){let e=r.charCodeAt(0),n=75-m;e>n&&(e=n);for(let r=0;r<m;r++)document.getElementById(String.fromCharCode(e++)+t).style.backgroundColor="grey"}},u=function(e){e.target.style.backgroundColor="white";let t=e.target.dataset.number,r=e.target.dataset.letter;if("V"===h){let e=11-m;t>e&&(t=e);for(let e=0;e<m;e++)document.getElementById(r+(+t+e)).style.backgroundColor="white"}else if("H"===h){let e=r.charCodeAt(0),n=75-m;e>n&&(e=n);for(let r=0;r<m;r++)document.getElementById(String.fromCharCode(e++)+t).style.backgroundColor="white"}};let m,g=[],p=[],h="V",v=["player1","player2"],y=v[0];document.getElementById("pip").textContent=y,document.getElementById("Chnge").addEventListener("click",(()=>{"V"===h?(h="H",document.getElementById("position").textContent="Horizontal"):"H"===h&&(h="V",document.getElementById("position").textContent="Vertical")}));const E=()=>{y===v[0]?(y=v[1],document.getElementById("pip").textContent=y):(v[1],y=v[0],document.getElementById("pip").textContent=y)};function C(e){console.log(e.target.dataset.letter);let t=g,r=e.target.dataset.letter+e.target.dataset.number;console.log(r),console.log(t.length),y===v[0]?t=p:y===v[1]&&(t=g);for(let e=0;e<t.length;e++)for(let n=0;n<t[e].coordinates.length;n++)t[e].coordinates[n]===r&&(console.log(t[e].coordinates),t[e].coordinates.splice(n,1),t[e].hitShip(),t[e].isSunk(),k(),console.log(t[e].coordinates),console.log("Player one sunk ships: 0"),console.log("Player two sunk ships: 0"));E()}function k(){let e,t=0,r=g;y===v[0]?(r=p,e="Player One"):y===v[1]&&(r=g,e="Player Two");for(let e=0;e<r.length;e++)0===r[e].coordinates.length&&++t;console.log(t),5===t&&alert(e+" has won!")}function b(){m=1,E();let e=document.querySelectorAll(".cell");for(let t=0;t<e.length;t++)e[t].removeEventListener("click",i),e[t].removeEventListener("click",b),e[t].style.backgroundColor="white";!function(){let e=document.querySelectorAll(".cell");for(let t=0;t<e.length;t++)e[t].addEventListener("click",C),e[t].style.backgroundColor="white",e[t].addEventListener("mouseover",(e=>{e.target.style.backgroundColor="red"})),e[t].addEventListener("mouseleave",(e=>{e.target.style.backgroundColor="white"}))}()}const f={p1carrierShip:function(){t.createGameboard();let e=document.querySelectorAll(".cell");m=2;for(let t=0;t<e.length;t++)e[t].addEventListener("click",o),e[t].addEventListener("click",f.p1battleShip),e[t].addEventListener("mouseover",s),e[t].addEventListener("mouseleave",u)},p1battleShip:function(){let e=document.querySelectorAll(".cell");m=3;for(let t=0;t<e.length;t++)e[t].removeEventListener("click",o),e[t].removeEventListener("click",f.p1battleShip),e[t].addEventListener("click",a),e[t].addEventListener("click",f.p1cruiserShip),e[t].addEventListener("mouseover",s),e[t].addEventListener("mouseleave",u)},p1cruiserShip:function(){let e=document.querySelectorAll(".cell");m=4;for(let t=0;t<e.length;t++)e[t].removeEventListener("click",a),e[t].removeEventListener("click",f.p1cruiserShip),e[t].addEventListener("click",c),e[t].addEventListener("click",f.p1submarineShip),e[t].addEventListener("mouseover",s),e[t].addEventListener("mouseleave",u)},p1submarineShip:function(){let e=document.querySelectorAll(".cell");m=5;for(let t=0;t<e.length;t++)e[t].removeEventListener("click",c),e[t].removeEventListener("click",f.p1submarineShip),e[t].addEventListener("click",d),e[t].addEventListener("click",f.p1destroyerShip),e[t].addEventListener("mouseover",s),e[t].addEventListener("mouseleave",u)},p1destroyerShip:function(){let e=document.querySelectorAll(".cell");m=6;for(let t=0;t<e.length;t++)e[t].removeEventListener("click",d),e[t].removeEventListener("click",f.p1destroyerShip),e[t].addEventListener("click",i),y===v[1]?e[t].addEventListener("click",b):y===v[0]&&e[t].addEventListener("click",f.loop),e[t].addEventListener("mouseover",s),e[t].addEventListener("mouseleave",u)},loop:function(){E();let e=document.querySelectorAll(".cell");for(let t=0;t<e.length;t++)e[t].removeEventListener("click",i),e[t].removeEventListener("click",f.loop),e[t].style.backgroundColor="white";f.p1carrierShip()}};f.p1carrierShip()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LGlCQUFpQixRQUFRWSxFQUFnQk0sTUFFNUVWLEVBQU1uRCxHQUFHMkMsaUJBQWlCLFlBQVlKLEdBQzFDWSxFQUFNbkQsR0FBRzJDLGlCQUFpQixhQUFhSixJQXFCeUNzQixLQWpCcEYsV0FJQWpCLElBQ0ksSUFBSU8sRUFBUXBFLFNBQVNxRSxpQkFBaUIsU0FFdEMsSUFBSSxJQUFJcEQsRUFBRSxFQUFFQSxFQUFFbUQsRUFBTS9DLE9BQU9KLElBQ3ZCbUQsRUFBTW5ELEdBQUdxRCxvQkFBb0IsUUFBUWYsR0FDckNhLEVBQU1uRCxHQUFHcUQsb0JBQW9CLFFBQVFFLEVBQWdCTSxNQUNyRFYsRUFBTW5ELEdBQUdmLE1BQU15QyxnQkFBa0IsUUFFN0M2QixFQUFnQkMsa0JBY2hCRCxFQUFnQkMsaUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9iYXR0bGVzaGlwcy93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwcy93ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcHMvd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwcy8uL3NyYy9nYW1lYm9hcmQuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcHMvLi9zcmMvY2hvb3NlQ29vcmRpbmF0ZXMuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcHMvLi9zcmMvc2hpcHMuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcHMvLi9zcmMvZG9tLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXBzLy4vc3JjL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFRoZSByZXF1aXJlIHNjb3BlXG52YXIgX193ZWJwYWNrX3JlcXVpcmVfXyA9IHt9O1xuXG4iLCIvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9ucyBmb3IgaGFybW9ueSBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSAoZXhwb3J0cywgZGVmaW5pdGlvbikgPT4ge1xuXHRmb3IodmFyIGtleSBpbiBkZWZpbml0aW9uKSB7XG5cdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKGRlZmluaXRpb24sIGtleSkgJiYgIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBrZXkpKSB7XG5cdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZGVmaW5pdGlvbltrZXldIH0pO1xuXHRcdH1cblx0fVxufTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSAob2JqLCBwcm9wKSA9PiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCkpIiwiY29uc3QgR2FtZWJvYXJkTW9kdWxlID0gKCgpID0+IHtcblxuICAgIGxldCBib3JkID0gXCJzb2xpZCBibGFjayAycHhcIjtcbiAgICBsZXQgbm9ib3JkID0gXCJub25lXCI7XG4gICAgXG4gICAgXG4gICAgY29uc3QgY3JlYXRlR3JpZHMgPSAobHRyLG5vLGlkKSA9PntcbiAgICBsZXQgZ3JpZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIilcbiAgICBncmlkLnN0eWxlLnBhZGRpbmcgPSBcIjEwcHhcIjtcbiAgICAvL3RyeWluZyB0byB0YWtlIG91dCB0aGUgYm9yZGVyaW5nIG9mIHRoZSBub3QgaW4gcGxheSBjZWxsc1xuICAgIGlmKGlkPT09IDApe2dyaWQuc3R5bGUuYm9yZGVyPW5vYm9yZH1cbiAgICBlbHNlIGlmKG5vPT09MCl7Z3JpZC5zdHlsZS5ib3JkZXIgPSBub2JvcmQ7fVxuICAgIGVsc2V7Z3JpZC5zdHlsZS5ib3JkZXIgPSBib3JkO31cbiAgICBcbiAgICBcbiAgICBncmlkLnRleHRDb250ZW50ID0gaWQ7XG4gICAgZ3JpZC5zdHlsZS50ZXh0QWxpZ24gPSBcImNlbnRlclwiO1xuICAgIGlmKGlkPT09MCAmJiBsdHI9PT1cIjBcIil7Z3JpZC50ZXh0Q29udGVudCA9IG5vfVxuICAgIGVsc2UgaWYobm89PT0wICYmIGx0ciE9XCIwXCIpe2dyaWQudGV4dENvbnRlbnQgPSBsdHJ9XG4gICAgZ3JpZC5kYXRhc2V0LmhpdCA9IFwiTm9cIlxuICAgIGxldCBncmRhdGEgPSBncmlkLmRhdGFzZXQuaGl0O1xuICAgIGxldCBsZXR0ZXIgPSBncmlkLmRhdGFzZXQubGV0dGVyID0gbHRyO1xuICAgIGxldCBudW1iZXIgPSBncmlkLmRhdGFzZXQubnVtYmVyID0gbm87XG4gICAgLy9zaG93cyB3aGljaCBwbGF5ZXIgb3ducyB0aGUgY2VsbC8vXG4gICAgLy9sZXQgcGxheWVyID0gZ3JpZC5kYXRhc2V0LnBsYXllcmNlbGwgPSBcInBsYXllclwiK3BseXI7XG4gICAgXG4gICAgLy9jcmVhdGluZyBhIGNsYXNzIGZvciBlYWNoIGdyaWQgc28gd2UgY2FuIGFjY2VzcyBpdCBmcm9tIHRoZSBmdW5jdGlvbnNcbiAgICBncmlkLmNsYXNzTGlzdC5hZGQoXCJjZWxsXCIpO1xuICAgIC8vY3JlYXRpbmcgYW4gaWQgdGhhdCBtYXRjaGVzIGl0cyBjb29yZGluYXRlc1xuICAgIGdyaWQuc2V0QXR0cmlidXRlKCdpZCcsZ3JpZC5kYXRhc2V0LmxldHRlcitncmlkLmRhdGFzZXQubnVtYmVyKVxuICAgIFxuICAgICAgICAgXG4gICAgbGV0IGdhbWVib2FyZCA9ICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImdhbWVib2FyZDFcIik7XG4gICAgXG4gICAgZ2FtZWJvYXJkLmFwcGVuZENoaWxkKGdyaWQpO1xuICAgIFxuICAgIH1cbiAgICBcbiAgICAvL2NyZWF0ZSB0aGUgd2hvbGUgZ3JpZCB3aXRoIGJlbG93IGZ1bmN0aW9uXG4gICAgY29uc3QgY3JlYXRlR2FtZWJvYXJkID0gKCkgPT57XG4gICAgXG4gICAgZm9yKGxldCBpPTA7aTwxMTtpKyspe1xuICAgICAgICBcbiAgICBcbiAgICAgICAgR2FtZWJvYXJkTW9kdWxlLmNyZWF0ZUdyaWRzKFwiMFwiLDAsaSlcbiAgICAgICAgR2FtZWJvYXJkTW9kdWxlLmNyZWF0ZUdyaWRzKFwiQVwiLGkpO1xuICAgICAgICBHYW1lYm9hcmRNb2R1bGUuY3JlYXRlR3JpZHMoXCJCXCIsaSk7XG4gICAgICAgIEdhbWVib2FyZE1vZHVsZS5jcmVhdGVHcmlkcyhcIkNcIixpKTtcbiAgICAgICAgR2FtZWJvYXJkTW9kdWxlLmNyZWF0ZUdyaWRzKFwiRFwiLGkpO1xuICAgICAgICBHYW1lYm9hcmRNb2R1bGUuY3JlYXRlR3JpZHMoXCJFXCIsaSk7XG4gICAgICAgIEdhbWVib2FyZE1vZHVsZS5jcmVhdGVHcmlkcyhcIkZcIixpKTtcbiAgICAgICAgR2FtZWJvYXJkTW9kdWxlLmNyZWF0ZUdyaWRzKFwiR1wiLGkpO1xuICAgICAgICBHYW1lYm9hcmRNb2R1bGUuY3JlYXRlR3JpZHMoXCJIXCIsaSk7XG4gICAgICAgIEdhbWVib2FyZE1vZHVsZS5jcmVhdGVHcmlkcyhcIklcIixpKTtcbiAgICAgICAgR2FtZWJvYXJkTW9kdWxlLmNyZWF0ZUdyaWRzKFwiSlwiLGkpO1xuICAgIFxuICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHtjcmVhdGVHcmlkcyxjcmVhdGVHYW1lYm9hcmR9XG4gICAgfSkoKTtcblxuICAgIGV4cG9ydHtHYW1lYm9hcmRNb2R1bGV9OyIsIi8vdGhlIGNob29vc2UgY29vcmRpbmF0ZXMgZnVuY3Rpb25cbmZ1bmN0aW9uIGNob29zZUNyZG50cyhTdHJ0THR0cnMsU3RydE5vLGxlbmd0aCxWb3JIKXtcbiAgICBsZXQgY29vcmQgPSBbXTtcbiAgICBcbiAgICBpZihWb3JIPT09XCJWXCIpe1xuICAgIGxldCBvdmVyID0gMTEtbGVuZ3RoO1xuICAgIC8vYnVpbGRpbmcgaXQgc28gd2hlbiB0aGUgdXNlciBzZWxlY3RzIGEgbnVtYmVyIGl0IGtlZXBzIGl0IHdpdGhpbiB0aGUgZ3JpZFxuICAgIGlmKFN0cnRObz5vdmVyKXtTdHJ0Tm8gPSBvdmVyfVxuICAgIC8vaWYoVm9ySD09PVwiVmVydGljYWxcIil7fSBXaWxsIGJlIHRyZWF0aW5nIHRoaXMgdGVzdGluZyBhcyBjb21wbGV0ZSB2ZXJ0aWNhbCBwb3NpdGlvbmluZ1xuICAgIGZvcihsZXQgaT0xO2k8bGVuZ3RoKzE7aSsrKXtcbiAgICAgICAgY29vcmQucHVzaChTdHJ0THR0cnMgKyBTdHJ0Tm8rKylcbiAgICB9XG59XG5cbmVsc2UgaWYoVm9ySD09PVwiSFwiKXtcbiAgICBsZXQgTHRyTnVtYmVyID0gU3RydEx0dHJzLmNoYXJDb2RlQXQoMClcbiAgICBsZXQgb3ZlciA9IDc1LWxlbmd0aDtcbiAgICAvL2J1aWxkaW5nIGl0IHNvIHdoZW4gdGhlIHVzZXIgc2VsZWN0cyBhIG51bWJlciBpdCBrZWVwcyBpdCB3aXRoaW4gdGhlIGdyaWRcbiAgICBpZihMdHJOdW1iZXI+b3Zlcil7THRyTnVtYmVyID0gb3Zlcn1cbiAgICBjb25zb2xlLmxvZyhMdHJOdW1iZXIpXG4gICAgY29uc29sZS5sb2cob3ZlcilcbiAgICBcbiAgICBmb3IobGV0IGk9MTtpPGxlbmd0aCsxO2krKyl7XG4gICAgICAgIGNvb3JkLnB1c2goU3RyaW5nLmZyb21DaGFyQ29kZShMdHJOdW1iZXIrKykgKyBTdHJ0Tm8pXG4gICAgfVxuXG59XG4gICAgcmV0dXJuIGNvb3JkO1xuXG59XG5cbmV4cG9ydCB7Y2hvb3NlQ3JkbnRzfSIsImltcG9ydHtwaXAsZGlyZWN0aW9uLHBsYXllcjFjb29yZCxwbGF5ZXIyY29vcmQscGxheWVyQmFzZX0gZnJvbSAnLi9pbmRleCdcbmltcG9ydHtjaG9vc2VDcmRudHN9IGZyb20gJy4vY2hvb3NlQ29vcmRpbmF0ZXMnXG5cblxuXG5mdW5jdGlvbiBzaGlwZmFjdG9yeShuYW1lLGNvb3JkaW5hdGVzKXtcbiAgICB0aGlzLm5hbWUgPSBuYW1lXG4gICAgdGhpcy5jb29yZGluYXRlcyA9IGNvb3JkaW5hdGVzXG4gICAgdGhpcy5oaXRTaGlwID0gKCk9PnthbGVydChcIllvdSBzdHJ1Y2sgdGhlIFwiICsgbmFtZSArIFwiIHNoaXBcIil9XG4gICAgdGhpcy5pc1N1bmsgPSAoKSA9PntpZihjb29yZGluYXRlcy5sZW5ndGg9PT0wKXthbGVydChcIllvdSBzdW5rIHRoZSBcIisgbmFtZSArXCIgc2hpcFwiKTt9fVxuICAgIFxuICB9XG5cbiAgbGV0IGNvb3JkaWQ7XG5cblxuICBjb25zdCBjYXJyaWVyID0gKHQpID0+eyAgICBcbiAgICB0LnRhcmdldC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcInJlZFwiO1xuICAgIGxldCBsZXR0ZXIgPSB0LnRhcmdldC5kYXRhc2V0LmxldHRlcjtcbiAgICBsZXQgbnVtYmVyID0gdC50YXJnZXQuZGF0YXNldC5udW1iZXI7XG4gICAgLy9hbGVydChcIllvdXIgYmF0dGxlc2hpcCB3aWxsIGhhdmUgdGhlIGNvb3JkaW5hdGVzOiBcIitjaG9vc2VDcmRudHMobGV0dGVyLG51bWJlciw/PyxkaXJlY3Rpb24pKVxuICAgIGxldCBndW5uID0gbmV3IHNoaXBmYWN0b3J5KFwiQ2FycmllclwiLGNob29zZUNyZG50cyhsZXR0ZXIsbnVtYmVyLDIsZGlyZWN0aW9uKSlcbiAgICBsZXQgUEM7XG4gICAgaWYocGlwID09PSBwbGF5ZXJCYXNlWzBdKXtQQyA9IHBsYXllcjFjb29yZDsgY29vcmRpZCA9IFwicDFjXCJ9XG4gICAgZWxzZSBpZihwaXAgPT09IHBsYXllckJhc2VbMV0pe1BDID0gcGxheWVyMmNvb3JkOyBjb29yZGlkID0gXCJwMmNcIn1cbiAgICBQQy5wdXNoKGd1bm4pO1xuICAgICAgICBcbiAgICAgIGxldCBwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInBcIilcbiAgICAgIHAudGV4dENvbnRlbnQgPSAnQ2FycmllcicgK1wiLVwiKyBjaG9vc2VDcmRudHMobGV0dGVyLG51bWJlciwyLGRpcmVjdGlvbilcbiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGNvb3JkaWQpLmFwcGVuZENoaWxkKHApO1xuICAgIFxuICAgIHJldHVybiBQQztcbiAgICB9XG5cbiAgY29uc3QgYmF0dGxlc2hpcCA9ICh0KSA9PntcbiAgICB0LnRhcmdldC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcInJlZFwiO1xuICAgIGxldCBsZXR0ZXIgPSB0LnRhcmdldC5kYXRhc2V0LmxldHRlcjtcbiAgICBsZXQgbnVtYmVyID0gdC50YXJnZXQuZGF0YXNldC5udW1iZXI7XG4gICAgLy9hbGVydChcIllvdXIgYmF0dGxlc2hpcCB3aWxsIGhhdmUgdGhlIGNvb3JkaW5hdGVzOiBcIitjaG9vc2VDcmRudHMobGV0dGVyLG51bWJlciw/PyxkaXJlY3Rpb24pKVxuICAgIGxldCBndW5uID0gbmV3IHNoaXBmYWN0b3J5KFwiQmF0dGxlc2hpcFwiLGNob29zZUNyZG50cyhsZXR0ZXIsbnVtYmVyLDMsZGlyZWN0aW9uKSlcbiAgICBsZXQgUEM7XG4gICAgaWYocGlwID09PSBwbGF5ZXJCYXNlWzBdKXtQQyA9IHBsYXllcjFjb29yZDsgY29vcmRpZCA9IFwicDFjXCJ9XG4gICAgZWxzZSBpZihwaXAgPT09IHBsYXllckJhc2VbMV0pe1BDID0gcGxheWVyMmNvb3JkOyBjb29yZGlkID0gXCJwMmNcIn1cbiAgICBQQy5wdXNoKGd1bm4pO1xuICAgIFxuXG4gICAgbGV0IHAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicFwiKVxuICAgICAgcC50ZXh0Q29udGVudCA9ICdCYXR0bGVTaGlwJyArXCItXCIrIGNob29zZUNyZG50cyhsZXR0ZXIsbnVtYmVyLDMsZGlyZWN0aW9uKVxuICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoY29vcmRpZCkuYXBwZW5kQ2hpbGQocCk7XG4gICAgXG4gICAgcmV0dXJuIFBDO1xuICB9XG4gIGNvbnN0IGNydWlzZXIgPSAodCkgPT57XG4gICAgdC50YXJnZXQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCJyZWRcIjtcbiAgICBsZXQgbGV0dGVyID0gdC50YXJnZXQuZGF0YXNldC5sZXR0ZXI7XG4gICAgbGV0IG51bWJlciA9IHQudGFyZ2V0LmRhdGFzZXQubnVtYmVyO1xuICAgIC8vYWxlcnQoXCJZb3VyIGJhdHRsZXNoaXAgd2lsbCBoYXZlIHRoZSBjb29yZGluYXRlczogXCIrY2hvb3NlQ3JkbnRzKGxldHRlcixudW1iZXIsPz8sZGlyZWN0aW9uKSlcbiAgICBsZXQgZ3VubiA9IG5ldyBzaGlwZmFjdG9yeShcIkNydWlzZXJcIixjaG9vc2VDcmRudHMobGV0dGVyLG51bWJlciw0LGRpcmVjdGlvbikpXG4gICAgbGV0IFBDO1xuICAgIGlmKHBpcCA9PT0gcGxheWVyQmFzZVswXSl7UEMgPSBwbGF5ZXIxY29vcmQ7IGNvb3JkaWQgPSBcInAxY1wifVxuICAgIGVsc2UgaWYocGlwID09PSBwbGF5ZXJCYXNlWzFdKXtQQyA9IHBsYXllcjJjb29yZDsgY29vcmRpZCA9IFwicDJjXCJ9XG4gICAgUEMucHVzaChndW5uKTtcbiAgICBcblxuICAgIGxldCBwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInBcIilcbiAgICAgIHAudGV4dENvbnRlbnQgPSAnQ3J1aXNlcicgK1wiLVwiKyBjaG9vc2VDcmRudHMobGV0dGVyLG51bWJlciw0LGRpcmVjdGlvbilcbiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGNvb3JkaWQpLmFwcGVuZENoaWxkKHApO1xuICAgIFxuICAgIHJldHVybiBQQztcbiAgfVxuICBjb25zdCBzdWJtYXJpbmUgPSAodCkgPT57XG4gICAgdC50YXJnZXQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCJyZWRcIjtcbiAgICBsZXQgbGV0dGVyID0gdC50YXJnZXQuZGF0YXNldC5sZXR0ZXI7XG4gICAgbGV0IG51bWJlciA9IHQudGFyZ2V0LmRhdGFzZXQubnVtYmVyO1xuICAgIC8vYWxlcnQoXCJZb3VyIGJhdHRsZXNoaXAgd2lsbCBoYXZlIHRoZSBjb29yZGluYXRlczogXCIrY2hvb3NlQ3JkbnRzKGxldHRlcixudW1iZXIsPz8sZGlyZWN0aW9uKSlcbiAgICBsZXQgZ3VubiA9IG5ldyBzaGlwZmFjdG9yeShcIlN1Ym1hcmluZVwiLGNob29zZUNyZG50cyhsZXR0ZXIsbnVtYmVyLDUsZGlyZWN0aW9uKSlcbiAgICBsZXQgUEM7XG4gICAgaWYocGlwID09PSBwbGF5ZXJCYXNlWzBdKXtQQyA9IHBsYXllcjFjb29yZDsgY29vcmRpZCA9IFwicDFjXCJ9XG4gICAgZWxzZSBpZihwaXAgPT09IHBsYXllckJhc2VbMV0pe1BDID0gcGxheWVyMmNvb3JkOyBjb29yZGlkID0gXCJwMmNcIn1cbiAgICBQQy5wdXNoKGd1bm4pO1xuICAgIFxuXG4gICAgbGV0IHAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicFwiKVxuICAgICAgcC50ZXh0Q29udGVudCA9ICdTdWJtYXJpbmUnICtcIi1cIisgY2hvb3NlQ3JkbnRzKGxldHRlcixudW1iZXIsNSxkaXJlY3Rpb24pXG4gICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChjb29yZGlkKS5hcHBlbmRDaGlsZChwKTtcbiAgICBcbiAgICByZXR1cm4gUEM7XG4gIH1cbiAgY29uc3QgZGVzdHJveWVyID0gKHQpID0+e1xuICAgIHQudGFyZ2V0LnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwicmVkXCI7XG4gICAgbGV0IGxldHRlciA9IHQudGFyZ2V0LmRhdGFzZXQubGV0dGVyO1xuICAgIGxldCBudW1iZXIgPSB0LnRhcmdldC5kYXRhc2V0Lm51bWJlcjtcbiAgICAvL2FsZXJ0KFwiWW91ciBiYXR0bGVzaGlwIHdpbGwgaGF2ZSB0aGUgY29vcmRpbmF0ZXM6IFwiK2Nob29zZUNyZG50cyhsZXR0ZXIsbnVtYmVyLD8/LGRpcmVjdGlvbikpXG4gICAgbGV0IGd1bm4gPSBuZXcgc2hpcGZhY3RvcnkoXCJEZXN0cm95ZXJcIixjaG9vc2VDcmRudHMobGV0dGVyLG51bWJlciw2LGRpcmVjdGlvbikpXG4gICAgbGV0IFBDO1xuICAgIGlmKHBpcCA9PT0gcGxheWVyQmFzZVswXSl7UEMgPSBwbGF5ZXIxY29vcmQ7IGNvb3JkaWQgPSBcInAxY1wifVxuICAgIGVsc2UgaWYocGlwID09PSBwbGF5ZXJCYXNlWzFdKXtQQyA9IHBsYXllcjJjb29yZDsgY29vcmRpZCA9IFwicDJjXCJ9XG4gICAgUEMucHVzaChndW5uKTtcblxuICAgIFxuICAgIFxuXG4gICAgbGV0IHAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicFwiKVxuICAgICAgcC50ZXh0Q29udGVudCA9ICdEZXN0cm95ZXInICtcIi1cIisgY2hvb3NlQ3JkbnRzKGxldHRlcixudW1iZXIsNixkaXJlY3Rpb24pXG4gICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChjb29yZGlkKS5hcHBlbmRDaGlsZChwKTtcbiAgICBcbiAgICByZXR1cm4gUEM7XG4gIH1cblxuICBleHBvcnQge3NoaXBmYWN0b3J5LGNhcnJpZXIsYmF0dGxlc2hpcCxjcnVpc2VyLHN1Ym1hcmluZSxkZXN0cm95ZXJ9IiwiaW1wb3J0IHtzcSxkaXJlY3Rpb24scGxheWVyMWNvb3JkLHBsYXllcjJjb29yZH0gZnJvbSAnLi9pbmRleCdcbmNvbnN0IGRvbU1vZHVsZSA9ICgoKSA9Pntcbi8vZnVuY3Rpb24gZm9yIGhpZ2hsaWdodGluZyBzcXVhcmVzIHdoZW4gaG92ZXJpbmdcbmZ1bmN0aW9uIGhvdmVyKHQpe3QudGFyZ2V0LnN0eWxlLmJhY2tncm91bmRDb2xvcj1cImdyZWVuXCI7XG5sZXQgbnVtYiA9IHQudGFyZ2V0LmRhdGFzZXQubnVtYmVyO1xubGV0IGxldHRlcnIgPSB0LnRhcmdldC5kYXRhc2V0LmxldHRlclxuaWYoZGlyZWN0aW9uPT09XCJWXCIpe1xuICAgIGxldCBvdmVyID0gMTEtc3E7XG4gICAgLy9idWlsZGluZyBpdCBzbyB3aGVuIHRoZSB1c2VyIHNlbGVjdHMgYSBudW1iZXIgaXQga2VlcHMgaXQgd2l0aGluIHRoZSBncmlkXG4gICAgaWYobnVtYj5vdmVyKXtudW1iID0gb3Zlcn1cbmZvcihsZXQgaT0wO2k8c3E7aSsrKXtcbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGxldHRlcnIrKCtudW1iK2kpKS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcImdyZXlcIn19XG5lbHNlIGlmKGRpcmVjdGlvbj09PVwiSFwiKXtcbiAgICBsZXQgTHRyTnVtYmVyID1sZXR0ZXJyLmNoYXJDb2RlQXQoMClcbiAgICBsZXQgb3ZlciA9IDc1LXNxO1xuICAgIC8vYnVpbGRpbmcgaXQgc28gd2hlbiB0aGUgdXNlciBzZWxlY3RzIGEgbnVtYmVyIGl0IGtlZXBzIGl0IHdpdGhpbiB0aGUgZ3JpZFxuICAgIGlmKEx0ck51bWJlcj5vdmVyKXtMdHJOdW1iZXIgPSBvdmVyfVxuICAgIGZvcihsZXQgaT0wO2k8c3E7aSsrKXtcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChTdHJpbmcuZnJvbUNoYXJDb2RlKEx0ck51bWJlcisrKSArIG51bWIpLnN0eWxlLmJhY2tncm91bmRDb2xvcj1cImdyZXlcIn1cbn1cbn1cblxuLy9mdW5jdGlvbiBmb3IgcmV0dXJuaW5nIHNxdWFyZSBjb2xvciB0byB3aGl0ZSBhZnRlciBsZWF2aW5nXG5mdW5jdGlvbiBsZWF2ZSh0KXt0LnRhcmdldC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3I9XCJ3aGl0ZVwiO1xubGV0IG51bWIgPSB0LnRhcmdldC5kYXRhc2V0Lm51bWJlcjtcbmxldCBsZXR0ZXJyID0gdC50YXJnZXQuZGF0YXNldC5sZXR0ZXJcbmlmKGRpcmVjdGlvbj09PVwiVlwiKXtcbiAgICBsZXQgb3ZlciA9IDExLXNxO1xuICAgIC8vYnVpbGRpbmcgaXQgc28gd2hlbiB0aGUgdXNlciBzZWxlY3RzIGEgbnVtYmVyIGl0IGtlZXBzIGl0IHdpdGhpbiB0aGUgZ3JpZFxuICAgIGlmKG51bWI+b3Zlcil7bnVtYiA9IG92ZXJ9XG4gICAgZm9yKGxldCBpPTA7aTxzcTtpKyspe1xuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGxldHRlcnIrKCtudW1iK2kpKS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcIndoaXRlXCJ9fVxuICAgIGVsc2UgaWYoZGlyZWN0aW9uPT09XCJIXCIpe1xuICAgICAgICBsZXQgTHRyTnVtYmVyID1sZXR0ZXJyLmNoYXJDb2RlQXQoMClcbiAgICAgICAgbGV0IG92ZXIgPSA3NS1zcTtcbiAgICAvL2J1aWxkaW5nIGl0IHNvIHdoZW4gdGhlIHVzZXIgc2VsZWN0cyBhIG51bWJlciBpdCBrZWVwcyBpdCB3aXRoaW4gdGhlIGdyaWRcbiAgICBpZihMdHJOdW1iZXI+b3Zlcil7THRyTnVtYmVyID0gb3Zlcn1cbiAgICAgICAgZm9yKGxldCBpPTA7aTxzcTtpKyspe1xuICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChTdHJpbmcuZnJvbUNoYXJDb2RlKEx0ck51bWJlcisrKSArIG51bWIpLnN0eWxlLmJhY2tncm91bmRDb2xvcj1cIndoaXRlXCJ9XG4gICAgfVxuICAgIH1cblxuICAgIC8vcmVtZW1iZXIgdG8gaW1wbGVtZW50IHRoaXMgYmVmb3JlIGZpbmlzaGluZyB1cCB0aGUgcHJvamVjdFxuICAgIC8vKioqXG4gICAgZnVuY3Rpb24gc2hvd0Nvb3JkcCgpe1xuICAgIGZvcihsZXQgaT0wO2k8cGxheWVyMWNvb3JkLmxlbmd0aDtpKyspe1xuICAgICAgICBsZXQgcCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJwXCIpXG4gICAgICAgIHAudGV4dENvbnRlbnQgPSBwbGF5ZXIxY29vcmRbaV0ubmFtZSArJy0nK3BsYXllcjFjb29yZFtpXS5jb29yZGluYXRlcztcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwMWNcIikuYXBwZW5kQ2hpbGQocCk7XG4gICAgICB9XG5cbiAgICAgIGZvcihsZXQgaT0wO2k8cGxheWVyMmNvb3JkLmxlbmd0aDtpKyspe1xuICAgICAgICBsZXQgcCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJwXCIpXG4gICAgICAgIHAudGV4dENvbnRlbnQgPSBwbGF5ZXIyY29vcmRbaV0ubmFtZSArJy0nK3BsYXllcjJjb29yZFtpXS5jb29yZGluYXRlcztcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwMmNcIikuYXBwZW5kQ2hpbGQocCk7XG4gICAgICB9fVxuXG5yZXR1cm4ge2hvdmVyLGxlYXZlLHNob3dDb29yZHB9XG59KSgpO1xuXG5cbmV4cG9ydHtkb21Nb2R1bGV9IiwiaW1wb3J0IHtHYW1lYm9hcmRNb2R1bGV9IGZyb20gJy4vZ2FtZWJvYXJkJ1xuaW1wb3J0IHtjYXJyaWVyLGJhdHRsZXNoaXAsY3J1aXNlcixzdWJtYXJpbmUsZGVzdHJveWVyfSBmcm9tICcuL3NoaXBzJ1xuaW1wb3J0IHtkb21Nb2R1bGV9IGZyb20gJy4vZG9tJ1xuXG5cblxuICAvL2Nvb3JkaW5hdGVzIG9mIGVhY2ggcGxheWVycyBzaGlwLCBqdXN0IGZvciB0ZXN0aW5nIHVudGlsIHdlIHVzZSBtdWx0aXBsZSBzaGlwc1xuICBsZXQgcGxheWVyMWNvb3JkPVtdO1xuICBsZXQgcGxheWVyMmNvb3JkPVtdO1xuICBsZXQgcGxheWVyMVN1bmtTaGlwcz0wO1xuICBsZXQgcGxheWVyMlN1bmtTaGlwcz0wO1xuICAvL1Y9VmVydGljYWwsIEg9SG9yaXpvbnRhbFxuICBsZXQgZGlyZWN0aW9uID0gXCJWXCJcbiAgLy9wbGF5ZXIgaW4gcGxheVxuICBsZXQgcGxheWVyQmFzZSA9IFtcInBsYXllcjFcIixcInBsYXllcjJcIl07XG4gIGxldCBwaXAgPSBwbGF5ZXJCYXNlWzBdO1xuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInBpcFwiKS50ZXh0Q29udGVudCA9IHBpcDtcbiAgLy90aGUgc3F1YXJlcyB0aGF0IG5lZWQgaGlnaGxpZ2h0aW5nIGZvciB0aGUgZG9tXG4gIGxldCBzcTtcbiAgXG5cbi8vYnV0dG9uIHRvIGNoYW5nZSB0aGUgcG9zaXRpb25pbmcgb2YgdGhlIHBsYWNlbWVudFxuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJDaG5nZVwiKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsKCk9PntpZihkaXJlY3Rpb249PT1cIlZcIil7ZGlyZWN0aW9uPVwiSFwiO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicG9zaXRpb25cIikudGV4dENvbnRlbnQ9XCJIb3Jpem9udGFsXCI7fWVsc2UgaWYoZGlyZWN0aW9uPT09XCJIXCIpe2RpcmVjdGlvbj1cIlZcIjtkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInBvc2l0aW9uXCIpLnRleHRDb250ZW50PVwiVmVydGljYWxcIn19KVxuXG5cbi8vZnVuY3Rpb24gY2hhbmdlcyBwbGF5ZXJcbmNvbnN0IGNoYW5QbGF5ZXIgPSAoKT0+e1xuICAgIGlmKHBpcCA9PT0gcGxheWVyQmFzZVswXSl7cGlwID0gcGxheWVyQmFzZVsxXTsgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwaXBcIikudGV4dENvbnRlbnQgPSBwaXA7fVxuICAgIGVsc2UgaWYocGlwID09PSBwbGF5ZXJCYXNlWzFdKXtwaXAgPSBwbGF5ZXJCYXNlWzBdO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicGlwXCIpLnRleHRDb250ZW50ID0gcGlwO31cbiAgICBlbHNle3BpcCA9IHBsYXllckJhc2VbMF07ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwaXBcIikudGV4dENvbnRlbnQgPSBwaXA7fVxuXG59XG5cblxuLy9iZWxvdyBmdW5jdGlvbnMgbmVlZCB0byBiZSBncm91cGVkIGludG8gYSBtb2R1bGVcblxuZnVuY3Rpb24gaGl0KHQpe2NvbnNvbGUubG9nKHQudGFyZ2V0LmRhdGFzZXQubGV0dGVyKTtcbiAgICBsZXQgUEMgPSBwbGF5ZXIxY29vcmQ7XG4gICAgbGV0IEwgPSB0LnRhcmdldC5kYXRhc2V0LmxldHRlcjtcbiAgICBsZXQgTiA9IHQudGFyZ2V0LmRhdGFzZXQubnVtYmVyO1xuICAgIGxldCBoaXRDb29yZCA9IEwrTjtcbiAgICBjb25zb2xlLmxvZyhoaXRDb29yZCk7XG4gICAgY29uc29sZS5sb2coUEMubGVuZ3RoKTtcbiAgICBcbiAgICBcbiAgICBcbiAgICBpZihwaXAgPT09IHBsYXllckJhc2VbMF0pe1BDID0gcGxheWVyMmNvb3JkO31cbiAgICBlbHNlIGlmKHBpcCA9PT0gcGxheWVyQmFzZVsxXSl7UEMgPSBwbGF5ZXIxY29vcmQ7fVxuICAgIGZvcihsZXQgcD0wO3A8UEMubGVuZ3RoO3ArKyl7XG4gICAgICAgIGZvcihsZXQgaT0wO2k8UENbcF0uY29vcmRpbmF0ZXMubGVuZ3RoO2krKyl7XG4gICAgICAgIGlmKFBDW3BdLmNvb3JkaW5hdGVzW2ldPT09aGl0Q29vcmQpe1xuICAgICAgICAgICAgY29uc29sZS5sb2coUENbcF0uY29vcmRpbmF0ZXMpXG4gICAgICAgICAgICBQQ1twXS5jb29yZGluYXRlcy5zcGxpY2UoaSwxKVxuICAgICAgICBQQ1twXS5oaXRTaGlwKCk7XG4gICAgICAgIFBDW3BdLmlzU3VuaygpOyAgICAgICAgXG4gICAgICAgIGdhbWVPdmVyKCk7XG4gICAgICAgIGNvbnNvbGUubG9nKFBDW3BdLmNvb3JkaW5hdGVzKVxuICAgICAgICBjb25zb2xlLmxvZyhcIlBsYXllciBvbmUgc3VuayBzaGlwczogXCIrIHBsYXllcjFTdW5rU2hpcHMpICBcbiAgICAgICAgY29uc29sZS5sb2coXCJQbGF5ZXIgdHdvIHN1bmsgc2hpcHM6IFwiKyBwbGF5ZXIyU3Vua1NoaXBzKSAgXG4gICAgICAgIFxuICAgICAgICB9fVxuICAgIH1cbiAgICBjaGFuUGxheWVyKCk7fVxuXG5cbiBmdW5jdGlvbiBnYW1lT3Zlcigpe1xuICAgIGxldCBjb3VudCA9MDtcbiAgICBsZXQgUEMgPSBwbGF5ZXIxY29vcmQ7XG4gICAgbGV0IHBscjtcbiAgICBpZihwaXAgPT09IHBsYXllckJhc2VbMF0pe1BDID0gcGxheWVyMmNvb3JkOyBwbHI9XCJQbGF5ZXIgT25lXCJ9XG4gICAgZWxzZSBpZihwaXAgPT09IHBsYXllckJhc2VbMV0pe1BDID0gcGxheWVyMWNvb3JkOyBwbHI9XCJQbGF5ZXIgVHdvXCJ9XG4gICAgZm9yKGxldCBpID0wO2k8UEMubGVuZ3RoO2krKyl7XG4gICAgICAgaWYoUENbaV0uY29vcmRpbmF0ZXMubGVuZ3RoPT09MCl7Kytjb3VudH1cbiAgICB9XG4gICAgY29uc29sZS5sb2coY291bnQpO1xuICAgIGlmKGNvdW50PT09NSl7YWxlcnQoIHBscisgXCIgaGFzIHdvbiFcIil9XG4gICAgfVxuICAgIFxuXG5mdW5jdGlvbiBzdGFydEdhbWUoKXtcbiAgICBzcT0xXG4gICAgY2hhblBsYXllcigpO1xuICAgIGxldCBjZWxscz0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5jZWxsXCIpO1xuZm9yKGxldCBpPTA7aTxjZWxscy5sZW5ndGg7aSsrKXtcbiAgICBjZWxsc1tpXS5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsZGVzdHJveWVyKSBcbmNlbGxzW2ldLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJyxzdGFydEdhbWUpXG5jZWxsc1tpXS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcIndoaXRlXCI7XG59XG5wbGF5R2FtZSgpO31cbiAgICBcbiAgICBcbmZ1bmN0aW9uIHBsYXlHYW1lKCl7XG4gICAgXG4gICAgbGV0IGNlbGxzPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmNlbGxcIik7XG5mb3IobGV0IGk9MDtpPGNlbGxzLmxlbmd0aDtpKyspe1xuXG5jZWxsc1tpXS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsaGl0KVxuY2VsbHNbaV0uc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCJ3aGl0ZVwiO1xuY2VsbHNbaV0uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VvdmVyJywodCk9Pnt0LnRhcmdldC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3I9XCJyZWRcIn0pXG5jZWxsc1tpXS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywodCk9Pnt0LnRhcmdldC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3I9XCJ3aGl0ZVwifSlcbn1cblxufVxuXG5cblxuXG4vL1NlbGVjdGlvbiBtb2R1bGVcbmNvbnN0IHNlbGVjdGlvbk1vZHVsZSA9ICgoKSA9PntcblxuICAgICAgICBcbiAgICAvL2FkZHMgYW4gZXZlbnQgbGlzdGVuZXIgdG8gZXZlcnkgZ3JpZCBjZWxsIGFsbG93aW5nIHVzIHRvIGNob29zZSBvdXIgY29vcmRpbmF0ZXMsbWFwIHRoZW0gdG8gdGhlIGFycmF5IHRoZW4gY2hhbmdlIHBsYXllclxuICAgIGZ1bmN0aW9uIHAxY2FycmllclNoaXAoKXtcbiAgICAgICBcbiAgICAgICAgR2FtZWJvYXJkTW9kdWxlLmNyZWF0ZUdhbWVib2FyZCgpO1xuICAgICAgICBsZXQgY2VsbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmNlbGxcIilcbiAgICAgICAgLy9zcSBpcyBjb250cm9sbGluZyB0aGUgaGlnaGxpZ2h0aW5nIG51bWJlclxuICAgICAgICBzcT0yO1xuICAgICAgICBmb3IobGV0IGk9MDtpPGNlbGxzLmxlbmd0aDtpKyspe1xuICAgICAgICAgICAgY2VsbHNbaV0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLGNhcnJpZXIpIFxuICAgICAgICAgICAgY2VsbHNbaV0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLHNlbGVjdGlvbk1vZHVsZS5wMWJhdHRsZVNoaXApIFxuICAgICAgICAgICAgY2VsbHNbaV0uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VvdmVyJyxkb21Nb2R1bGUuaG92ZXIpXG4gICAgICAgIGNlbGxzW2ldLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLGRvbU1vZHVsZS5sZWF2ZSlcbiAgICAgICAgfVxuICAgICAgICB9XG4gICAgZnVuY3Rpb24gcDFiYXR0bGVTaGlwKCl7XG4gICAgICAgIFxuICAgICAgICBsZXQgY2VsbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmNlbGxcIilcbiAgICAgICAgXG4gICAgICAgIC8vc3EgaXMgY29udHJvbGxpbmcgdGhlIGhpZ2hsaWdodGluZyBudW1iZXJcbiAgICAgICAgc3E9MztcbiAgICAgICAgZm9yKGxldCBpPTA7aTxjZWxscy5sZW5ndGg7aSsrKXtcbiAgICAgICAgICAgIGNlbGxzW2ldLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJyxjYXJyaWVyKSBcbiAgICAgICAgICAgIGNlbGxzW2ldLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJyxzZWxlY3Rpb25Nb2R1bGUucDFiYXR0bGVTaGlwKSBcbiAgICAgICAgICAgIGNlbGxzW2ldLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJyxiYXR0bGVzaGlwKSBcbiAgICAgICAgICAgIGNlbGxzW2ldLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJyxzZWxlY3Rpb25Nb2R1bGUucDFjcnVpc2VyU2hpcCkgXG4gICAgICAgICAgICBjZWxsc1tpXS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW92ZXInLGRvbU1vZHVsZS5ob3ZlcilcbiAgICAgICAgY2VsbHNbaV0uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsZG9tTW9kdWxlLmxlYXZlKVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcDFjcnVpc2VyU2hpcCgpe1xuICAgICAgICBcbiAgICAgICAgbGV0IGNlbGxzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5jZWxsXCIpXG4gICAgICAgIFxuICAgICAgICAvL3NxIGlzIGNvbnRyb2xsaW5nIHRoZSBoaWdobGlnaHRpbmcgbnVtYmVyXG4gICAgICAgIHNxPTQ7XG4gICAgICAgIGZvcihsZXQgaT0wO2k8Y2VsbHMubGVuZ3RoO2krKyl7XG4gICAgICAgICAgICBjZWxsc1tpXS5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsYmF0dGxlc2hpcCkgXG4gICAgICAgICAgICBjZWxsc1tpXS5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsc2VsZWN0aW9uTW9kdWxlLnAxY3J1aXNlclNoaXApIFxuICAgICAgICAgICAgY2VsbHNbaV0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLGNydWlzZXIpIFxuICAgICAgICAgICAgY2VsbHNbaV0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLHNlbGVjdGlvbk1vZHVsZS5wMXN1Ym1hcmluZVNoaXApIFxuICAgICAgICAgICAgY2VsbHNbaV0uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VvdmVyJyxkb21Nb2R1bGUuaG92ZXIpXG4gICAgICAgIGNlbGxzW2ldLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLGRvbU1vZHVsZS5sZWF2ZSlcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHAxc3VibWFyaW5lU2hpcCgpe1xuICAgICAgICBcbiAgICAgICAgbGV0IGNlbGxzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5jZWxsXCIpXG4gICAgICAgIFxuICAgICAgICAvL3NxIGlzIGNvbnRyb2xsaW5nIHRoZSBoaWdobGlnaHRpbmcgbnVtYmVyXG4gICAgICAgIHNxPTU7XG4gICAgICAgIGZvcihsZXQgaT0wO2k8Y2VsbHMubGVuZ3RoO2krKyl7XG4gICAgICAgICAgICBjZWxsc1tpXS5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsY3J1aXNlcikgXG4gICAgICAgICAgICBjZWxsc1tpXS5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsc2VsZWN0aW9uTW9kdWxlLnAxc3VibWFyaW5lU2hpcCkgXG4gICAgICAgICAgICBjZWxsc1tpXS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsc3VibWFyaW5lKSBcbiAgICAgICAgICAgIGNlbGxzW2ldLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJyxzZWxlY3Rpb25Nb2R1bGUucDFkZXN0cm95ZXJTaGlwKSBcbiAgICAgICAgICAgIGNlbGxzW2ldLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlb3ZlcicsZG9tTW9kdWxlLmhvdmVyKVxuICAgICAgICBjZWxsc1tpXS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJyxkb21Nb2R1bGUubGVhdmUpXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBwMWRlc3Ryb3llclNoaXAoKXtcbiAgICAgICAgXG4gICAgICAgIGxldCBjZWxscyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuY2VsbFwiKVxuICAgICAgICBcbiAgICAgICAgLy9zcSBpcyBjb250cm9sbGluZyB0aGUgaGlnaGxpZ2h0aW5nIG51bWJlclxuICAgICAgICBzcT02O1xuICAgICAgICBmb3IobGV0IGk9MDtpPGNlbGxzLmxlbmd0aDtpKyspe1xuICAgICAgICAgICAgY2VsbHNbaV0ucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLHN1Ym1hcmluZSkgXG4gICAgICAgICAgICBjZWxsc1tpXS5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsc2VsZWN0aW9uTW9kdWxlLnAxZGVzdHJveWVyU2hpcCkgXG4gICAgICAgICAgICBjZWxsc1tpXS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsZGVzdHJveWVyKSBcbiAgICAgICAgICAgIC8vdGhpcyBkZWNpZGVzIHdoZXRoZXIgdGhlIGdhbWUgc3RhcnRzIGFmdGVyIHBsYXllciB0d28gb3IgdGhlIGNvbXB1dGVyIGhhcyBzZWxlY3RlZCB0aGVpciBncmlkc1xuICAgICAgICAgICAgLy9pZiBub3QgaXQgbG9vcHMgYXJvdW5kXG4gICAgICAgICAgICBpZihwaXAgPT09IHBsYXllckJhc2VbMV0pe2NlbGxzW2ldLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJyxzdGFydEdhbWUpfVxuICAgICAgIGVsc2UgaWYocGlwID09PSBwbGF5ZXJCYXNlWzBdKXtjZWxsc1tpXS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsc2VsZWN0aW9uTW9kdWxlLmxvb3ApIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY2VsbHNbaV0uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VvdmVyJyxkb21Nb2R1bGUuaG92ZXIpXG4gICAgICAgIGNlbGxzW2ldLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLGRvbU1vZHVsZS5sZWF2ZSlcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGxvb3AoKXtcblxuICAgICAgICAvL1RoaXMgZnVuY3Rpb24gdHVybnMgdGhlIHNlbGVjdGlvbiBwcm9jZXNzIG92ZXIgdG8gZWl0aGVyIGEgY29tcHV0ZXIgb3IgcGxheWVyIDJcbiAgICAvL2p1c3QgZG9pbmcgcGxheWVyIDIgaW1wbGVtZXRhdGlvbiBmb3Igbm93XG4gICAgY2hhblBsYXllcigpO1xuICAgICAgICBsZXQgY2VsbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmNlbGxcIilcbiAgICBcbiAgICAgICAgZm9yKGxldCBpPTA7aTxjZWxscy5sZW5ndGg7aSsrKXtcbiAgICAgICAgICAgIGNlbGxzW2ldLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJyxkZXN0cm95ZXIpIFxuICAgICAgICAgICAgY2VsbHNbaV0ucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLHNlbGVjdGlvbk1vZHVsZS5sb29wKSBcbiAgICAgICAgICAgIGNlbGxzW2ldLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwid2hpdGVcIjtcbiAgICB9XG5zZWxlY3Rpb25Nb2R1bGUucDFjYXJyaWVyU2hpcCgpO1xufVxuXG5cbiAgICBcbiAgICAgICAgcmV0dXJue3AxY2FycmllclNoaXAscDFiYXR0bGVTaGlwLHAxY3J1aXNlclNoaXAscDFzdWJtYXJpbmVTaGlwLHAxZGVzdHJveWVyU2hpcCxsb29wfVxuICAgIFxuICAgIH0pKCk7XG5cblxuXG5cblxuXG5zZWxlY3Rpb25Nb2R1bGUucDFjYXJyaWVyU2hpcCgpO1xuXG5cblxuZXhwb3J0IHtzcSxkaXJlY3Rpb24scGlwLHBsYXllcjFjb29yZCxwbGF5ZXIyY29vcmQscGxheWVyQmFzZSxjaGFuUGxheWVyLHBsYXllcjFTdW5rU2hpcHMscGxheWVyMlN1bmtTaGlwc31cblxuXG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG5cbiJdLCJuYW1lcyI6WyJfX3dlYnBhY2tfcmVxdWlyZV9fIiwiZXhwb3J0cyIsImRlZmluaXRpb24iLCJrZXkiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0Iiwib2JqIiwicHJvcCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsIkdhbWVib2FyZE1vZHVsZSIsImNyZWF0ZUdyaWRzIiwibHRyIiwibm8iLCJpZCIsImdyaWQiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJzdHlsZSIsInBhZGRpbmciLCJib3JkZXIiLCJ0ZXh0Q29udGVudCIsInRleHRBbGlnbiIsImRhdGFzZXQiLCJoaXQiLCJsZXR0ZXIiLCJudW1iZXIiLCJjbGFzc0xpc3QiLCJhZGQiLCJzZXRBdHRyaWJ1dGUiLCJnZXRFbGVtZW50QnlJZCIsImFwcGVuZENoaWxkIiwiY3JlYXRlR2FtZWJvYXJkIiwiaSIsImNob29zZUNyZG50cyIsIlN0cnRMdHRycyIsIlN0cnRObyIsImxlbmd0aCIsIlZvckgiLCJjb29yZCIsIm92ZXIiLCJwdXNoIiwiTHRyTnVtYmVyIiwiY2hhckNvZGVBdCIsImNvbnNvbGUiLCJsb2ciLCJTdHJpbmciLCJmcm9tQ2hhckNvZGUiLCJzaGlwZmFjdG9yeSIsIm5hbWUiLCJjb29yZGluYXRlcyIsInRoaXMiLCJoaXRTaGlwIiwiYWxlcnQiLCJpc1N1bmsiLCJjb29yZGlkIiwiY2FycmllciIsInQiLCJ0YXJnZXQiLCJiYWNrZ3JvdW5kQ29sb3IiLCJQQyIsImd1bm4iLCJkaXJlY3Rpb24iLCJwaXAiLCJwbGF5ZXJCYXNlIiwicGxheWVyMWNvb3JkIiwicGxheWVyMmNvb3JkIiwicCIsImJhdHRsZXNoaXAiLCJjcnVpc2VyIiwic3VibWFyaW5lIiwiZGVzdHJveWVyIiwiZG9tTW9kdWxlIiwibnVtYiIsImxldHRlcnIiLCJzcSIsImFkZEV2ZW50TGlzdGVuZXIiLCJjaGFuUGxheWVyIiwiaGl0Q29vcmQiLCJzcGxpY2UiLCJnYW1lT3ZlciIsInBsciIsImNvdW50Iiwic3RhcnRHYW1lIiwiY2VsbHMiLCJxdWVyeVNlbGVjdG9yQWxsIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInBsYXlHYW1lIiwic2VsZWN0aW9uTW9kdWxlIiwicDFjYXJyaWVyU2hpcCIsInAxYmF0dGxlU2hpcCIsInAxY3J1aXNlclNoaXAiLCJwMXN1Ym1hcmluZVNoaXAiLCJwMWRlc3Ryb3llclNoaXAiLCJsb29wIl0sInNvdXJjZVJvb3QiOiIifQ==